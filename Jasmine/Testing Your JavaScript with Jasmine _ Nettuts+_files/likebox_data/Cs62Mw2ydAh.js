/*1341287428,176820665*/

if (window.CavalryLogger) { CavalryLogger.start_js(["4dPAF"]); }

__d("DragDropFileUpload",[],function(a,b,c,d,e,f){f.isSupported=function(){return typeof(FileList)!=="undefined";};});
__d("ArbiterDragDrop",["Arbiter","DragDropFileUpload"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DragDropFileUpload'),i='dnd/drag/in',j='dnd/drag/out',k='dnd/drag/drop',l=false,m=function(){if(l)return;l=true;if(!h.isSupported())return;if(!document.addEventListener)return;var o=0;document.addEventListener('dragenter',function(r){if(o===0)g.inform(i,r,g.BEHAVIOR_EVENT);o++;},false);document.addEventListener('dragleave',function(r){o--;if(o===0)g.inform(j,r,g.BEHAVIOR_EVENT);},false);document.addEventListener('drop',function(r){g.inform(k,r,g.BEHAVIOR_EVENT);r.preventDefault();},false);document.addEventListener('dragover',function(r){r.preventDefault();},false);var p=null,q=function(){o=0;g.inform(j,null,g.BEHAVIOR_EVENT);};document.addEventListener('dragover',function(r){p&&window.clearTimeout(p);p=window.setTimeout(q,839);},true);},n=function(o){m();return o;};e.exports={dragEnter:n.bind(null,i),dragLeave:n.bind(null,j),dragDrop:n.bind(null,k)};});
__d("css_on_global_drag",["ArbiterDragDrop","Arbiter","CSS"],function(a,b,c,d,e,f){var g=b('ArbiterDragDrop'),h=b('Arbiter'),i=b('CSS');e.exports=function(j,k){var l=h.subscribe(g.dragEnter(),i.addClass.bind(i,j,k),h.SUBSCRIBE_NEW),m=h.subscribe(g.dragLeave(),i.removeClass.bind(i,j,k),h.SUBSCRIBE_NEW);return function(){l.unsubscribe();m.unsubscribe();};};});
__d("DragDropTarget",["CSS","DragDropFileUpload","copyProperties","css_on_global_drag"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DragDropFileUpload'),i=b('copyProperties'),j=b('css_on_global_drag');function k(l,m){this.element=l;this.preprocess=function(n){return n;};this.onDrop=m;}i(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},activate:function(){if(!h.isSupported())return;if(!document.addEventListener)return;var l=j(this.element,'fbWantsDragDrop'),m=0;this.element.addEventListener('dragenter',(function(){if(m===0)g.addClass(this.element,'fbDropReady');m++;}).bind(this),false);var n=g.removeClass.bind(g,this.element,'fbDropReady');this.element.addEventListener('dragleave',(function(){m=Math.max(m-1,0);if(m===0)n();}).bind(this),false);this.element.addEventListener('dragover',function(o){o.preventDefault();o.stopPropagation();},false);this.element.addEventListener('drop',(function(o){o.preventDefault();o.stopPropagation();var p=this.preprocess(o.dataTransfer.files);m=0;n();if(p.length)this.onDrop(p);}).bind(this),false);}});e.exports=k;});
__d("AsyncUploadRequest",["ArbiterMixin","AsyncRequest","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('copyProperties');function j(l){this.setURI(l);}j.isSupported=function(){return ('FileList' in window)&&('FormData' in window);};i(j.prototype,g,{_limit:10,setAllowCrossOrigin:function(l){this._allowCrossOrigin=!!l;return this;},setData:function(l){this._data=l;return this;},setFiles:function(l){var m={};for(var n in l){var o=l[n];if(Array.isArray(o)){m[n]=o;}else{m[n]=[];if(o instanceof window.FileList){for(var p=0;p<o.length;p++)m[n].push(o.item(p));}else if(o instanceof window.File)m[n].push(o);}}this._files=m;return this;},setLimit:function(l){this._limit=l;return this;},setRelativeTo:function(l){this._relativeTo=l;return this;},setURI:function(l){this._uri=l;return this;},send:function(){if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var l in this._files)this._files[l].forEach(function(m){this._uploads.push(new k(l,m));}.bind(this));this._waiting=this._uploads.slice(0);this._pending=[];this._processQueue();},_processQueue:function(){while(this._pending.length<this._limit){if(!this._waiting.length)break;var l=this._waiting.shift();this._processUpload(l);this._pending.push(l);}},_processUpload:function(l){this.inform('start',l);var m=new FormData();if(this._data)for(var n in this._data)m.append(n,this._data[n]);m.append(l.getName(),l.getFile());new h().setAllowCrossOrigin(this._allowCrossOrigin).setURI(this._uri).setRawData(m).setRelativeTo(this._relativeTo).setStatusElement(this._relativeTo).setHandler(this._success.bind(this,l)).setErrorHandler(this._failure.bind(this,l)).setUploadProgressHandler(this._progress.bind(this,l)).send();},_success:function(l,m){this.inform('success',l.handleSuccess(m));this._complete(l);},_failure:function(l,m){this.inform('failure',l.handleFailure(m));this._complete(l);},_progress:function(l,event){this.inform('progress',l.handleProgress(event));},_complete:function(l){this._pending.remove(l);this._processQueue();if(!this._pending.length){this._inFlight=false;this.inform('complete',this._uploads);}}});var k=function(l,m){this._name=l;this._file=m;this._success=null;this._response=null;this._progressEvent=null;};i(k.prototype,{getName:function(){return this._name;},getFile:function(){return this._file;},isComplete:function(){return this._success!==null;},isSuccess:function(){return this._success===true;},getResponse:function(){return this._response;},getProgressEvent:function(){return this._progressEvent;},handleSuccess:function(l){this._success=true;this._response=l;this._progressEvent=null;return this;},handleFailure:function(l){this._success=false;this._response=l;this._progressEvent=null;return this;},handleProgress:function(event){this._progressEvent=event;return this;}});e.exports=j;});
__d("FileUploadTarget",["AsyncUploadRequest","DragDropFileUpload","DragDropTarget","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncUploadRequest'),h=b('DragDropFileUpload'),i=b('DragDropTarget'),j=b('copyProperties');function k(l,m){var n=(function(o){var p=new g(m).setFiles({file:o}).setRelativeTo(l);p.subscribe('complete',function(q,r){this.onCompleteCallback(r);}.bind(this));p.send();}).bind(this);this.dragDropTarget=new i(l,(function(o){o.length&&this.asyncProcess(o,function(p){p.length&&n(p);});}).bind(this));this.asyncProcess=function(o,p){p(o);};this.preprocess=function(o){return o;};this.onCompleteCallback=bagofholding;}j(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},setAsyncProcessor:function(l){this.asyncProcess=l;return this;},onComplete:function(l){this.onCompleteCallback=l;return this;},activate:function(){if(!h.isSupported())return;this.dragDropTarget.setPreprocessor(this.preprocess).activate();}});e.exports=k;});
__d("SinglePictureUploadTarget",["Bootloader","Dialog","ErrorDialog","FileUploadTarget","StringEscape","tx","copyProperties"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Dialog'),i=b('ErrorDialog'),j=b('FileUploadTarget'),k=b('StringEscape'),l=b('tx'),m=b('copyProperties');function n(o,p){this.fileUploadTarget=new j(o,p);this.preprocessCallback=bagofholding;this.oncompleteCallback=bagofholding;this.afterSuccessCallback=bagofholding;this.maxWidth=null;this.maxHeight=null;}m(n.prototype,{setPreprocessCallback:function(o){this.preprocessCallback=o;return this;},setOncompleteCallback:function(o){this.oncompleteCallback=o;return this;},setAfterSuccessCallback:function(o){this.afterSuccessCallback=o;return this;},setMaximumDimensions:function(o,p){this.maxWidth=o;this.maxHeight=p;return this;},activate:function(){var o=function(s){return k.htmlSpecialChars(s.name);},p=(function(s){if(s.length>1){i.show("Upload Error",l._("You can only select {max-photos} photos to upload to this album.  Only the first {max-photos} photo you selected will be uploaded.",{'max-photos':1}));s=[s[0]];}var t=s[0];if(!t.type.match(/^image\//)){i.show("Upload Error",l._("We could not understand the contents of {filename}.  Make sure it is a jpg, gif, or png formatted image.",{filename:o(t)}));return [];}this.preprocessCallback(s);return s;}).bind(this),q=(function(s,t){var u=1024*1024*16,v=1024*1024*1,w=function(y){if(y.size>u){i.show("Upload Error",l._("{filename} is too large. Please resize your photo to under\n                     8000x8000 pixels and try again.",{filename:o(s[0])}));t([]);}else t([y]);},x=s[0];if((x.size<v)||(!this.maxWidth&&!this.maxHeight)){w(x);}else g.loadModules(['ImageExif','ImageResizer'],function(y,z){if(!z.isSupported()){w(x);return;}var aa=new z(x,this.maxWidth,this.maxHeight);aa.subscribe('resized',function(ba,ca){if(ca.size>x.size){w(x);}else w(ca);}.bind(this));aa.subscribe('error',function(){w(x);}.bind(this));y.readFromFile(x,function(ba){ba&&aa.setOrientation(ba.Orientation);aa.resize();});});}).bind(this),r=(function(s){var t=s[0];this.oncompleteCallback(t);var u=t.getResponse().getPayload();if(t.isSuccess()){this.afterSuccessCallback(u);}else if(u&&u.__dialog){var v=new h();v._setFromModel(u.__dialog);v.setButtons(h.OK).show();}else i.show(u.error.title,u.error.body);}).bind(this);return this.fileUploadTarget.onComplete(r).setPreprocessor(p).setAsyncProcessor(q).activate();}});e.exports=n;});
__d("TimelineProfilePic",["Arbiter","CSS","Dialog","DOM","HTML","Run","$","ge","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('HTML'),l=b('Run'),m=b('$'),n=b('ge'),o=b('copyProperties');function p(q,r,s,t){p.destroyInstance();p._instance=this;this.leavingMessage=r;this.elemID=s||'fbProfileCover';this.elemClass=t||'.profilePicThumb';this._arbiterTokens=[g.subscribe(q.LOADING,this.startLoading.bind(this)),g.subscribe(q.SUCCESS,this.onUploadSuccess.bind(this))];l.onBeforeUnload(this.onBeforeUnload.bind(this));l.onLeave(this.destroy.bind(this));}o(p,{_instance:null,destroyInstance:function(){this._instance&&this._instance.destroy();}});o(p.prototype,{_setLoadingIndicator:function(q){this._loading=q;h.conditionClass(j.find(m(this.elemID),this.elemClass),'profilePicLoading',q);},destroy:function(){this._arbiterTokens.forEach(function(q){q.unsubscribe();});this._arbiterTokens=[];p._instance=null;},startLoading:function(q,r){this._setLoadingIndicator(r.isLoading);if(n('fbProfilePicSelector'))h.removeClass(m('fbProfilePicSelector'),'fbTimelineNullProfilePicSelector');},onUploadSuccess:function(q,r){this._setLoadingIndicator(false);var s=i.getCurrent();if(s)s.hide();j.replace(j.find(m(this.elemID),this.elemClass),k(r.newPic));if(typeof(r.profileId)!==undefined&&typeof(r.headerPicURL)!==undefined){var t=n('profile_pic_header_'+r.profileId);if(t)t.src=r.headerPicURL;}},onBeforeUnload:function(){if(p._instance===this&&this._loading)return this.leavingMessage;}});e.exports=p;});
__d("timeline-cover-dragdrop-edit",["SinglePictureUploadTarget","TimelineCover"],function(a,b,c,d,e,f){var g=b('SinglePictureUploadTarget'),h=b('TimelineCover'),i=function(){var m=h.getInstance();m.hideLoadingIndicator();},j=function(m){var n=h.getInstance(),o=m.id,p=m.photo_html;n.updateCoverImage(o,p);},k=function(m){h.getInstance().showLoadingIndicator();},l=function(m,n,o,p){new g(m,n).setMaximumDimensions(o,p).setPreprocessCallback(k).setOncompleteCallback(i).setAfterSuccessCallback(j).activate();};f.initialize_timeline_cover_drop_target=l;});
__d("profile-pic-dragdrop-edit",["Arbiter","SinglePictureUploadTarget","TimelineProfilePic"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('SinglePictureUploadTarget'),i=b('TimelineProfilePic');f.initialize_profile_pic_drop_target=function(j,k,l,m){new i(l,m);new h(j,k).setPreprocessCallback(function(n){g.inform(l.LOADING,{isLoading:1},g.BEHAVIOR_STATE);}).setOncompleteCallback(function(){g.inform(l.LOADING,{isLoading:0},g.BEHAVIOR_STATE);}).setAfterSuccessCallback(function(n){g.inform(l.SUCCESS,{newPic:n.photo_html},g.BEHAVIOR_STATE);}).activate();};});
function FutureProfileSideNav(){this.parent.construct(this);}Class.extend(FutureProfileSideNav,'FutureSideNav');copy_properties(FutureProfileSideNav.prototype,{init:function(){this.parent.init.apply(this,arguments);this.ajaxPipe=true;this.altKeyParam='v';this.sidecol=false;},_constructItem:function(a,b){return new FutureProfileSideNavItem(a,b);},_doPageTransition:function(a,b){if(!this._profileChanged(b)&&!this._scopeChanged(a))return this.parent._doPageTransition(a,b);},_profileChanged:function(a){var b=a.getQueryData(),c=this.uri.getQueryData();return (b.id!==c.id||b.viewas!==c.viewas||b.and!==c.and);},_scopeChanged:function(a){return (!this.selected||a.layoutType!==this.selected.layoutType);},_getKey:function(a){return this.parent._getKey(a)||a[this.altKeyParam];}});function FutureProfileSideNavItem(a,b){this.parent.construct(this,a,b);this.layoutType=a.layouttype;}Class.extend(FutureProfileSideNavItem,'FutureSideNavItem');
__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["event-extensions","function-extensions","Arbiter","AsyncRequest","CSS","DOM","ge","Menu","Parent","SubscriptionLevels"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('ge'),l=b('Menu'),m=b('Parent'),n=b('SubscriptionLevels'),o=13,p=45,q=[n.ALL,n.DEFAULT,n.TOP],r={},s={},t={},u={},v={},w={},x={},y={},z={},aa={},ba="/ajax/follow/follow_profile.php",ca="/ajax/follow/unfollow_profile.php",da={},ea={},fa=null;function ga(ab){return q.contains(ab);}function ha(ab,bb,cb,db){var eb=m.byClass(db,'uiMenuItem')||m.byClass(db,'uiMenuXItem');if(!eb||!j.contains(ab,eb)){return;}else if(i.hasClass(eb,'SubscribeMenuSubscribeCheckbox')){if(t[bb]){ka(ab,bb);}else ja(ab,bb);return false;}else if(i.hasClass(eb,'SubscribeMenuUnsubscribe')){ka(ab,bb);return false;}else if(i.hasClass(eb,'SubscribeMenuSettingsItem')){xa(ab,true);return false;}else if(i.hasClass(eb,'SubscriptionMenuGoBack')){xa(ab,false);return false;}else if(i.hasClass(eb,'SubscriptionMenuItem')){ia(ab,bb,cb,eb);return false;}}function ia(ab,bb,cb,db){if(i.hasClass(db,'SubscriptionMenuLevel')){if(l.isItemChecked(db))return;va(ab,bb,oa(db),true,cb);}else if(i.hasClass(db,'SubscriptionMenuCategory')){sa(bb,db,!l.isItemChecked(db),true,cb);}else if(i.hasClass(db,'SubscriptionAppStory'))ua(bb,db,!l.isItemChecked(db),cb);}function ja(ab,bb){var cb={profile_id:bb};g.inform('FollowingUser',cb);new h().setURI(ba).setMethod('POST').setData({profile_id:bb,location:la(ab)}).setErrorHandler(g.inform.curry('FollowUserFail',cb)).send();}function ka(ab,bb){var cb={profile_id:bb};g.inform('UnfollowingUser',cb);new h().setURI(ca).setMethod('POST').setData({profile_id:bb,location:la(ab)}).setErrorHandler(g.inform.curry('UnfollowUserFail',cb)).send();}function la(ab){if(i.hasClass(ab,'followButtonFlyout')){return o;}else return p;}function ma(ab,bb,cb){var db={profile_id:ab,level:x[ab],custom_categories:y[ab],location:cb};new h().setURI('/ajax/follow/manage_subscriptions.php').setData(db).send();}function na(ab,bb){var cb=y[bb]||[],db=l.getItems(ab);db.forEach(function(eb){if(i.hasClass(eb,'SubscriptionMenuCategory')){var fb=oa(eb);if(cb.contains(fb)){qa(eb);}else ra(eb);}else if(i.hasClass(eb,'SubscriptionAppStory')){var gb=oa(eb);if(ea[bb]&&ea[bb][gb]){qa(eb);}else ra(eb);}});va(ab,bb,x[bb],false);}function oa(ab){var bb=j.scry(ab,'input')[0];return bb&&bb.value;}function pa(ab){return j.find(ab,'a.itemAnchor');}function qa(ab){i.addClass(ab,'checked');pa(ab).setAttribute('aria-checked',true);}function ra(ab){i.removeClass(ab,'checked');pa(ab).setAttribute('aria-checked',false);}function sa(ab,bb,cb,db,eb){if(cb){qa(bb);}else ra(bb);var fb=oa(bb);if(ga(fb)){cb&&ta(ab,fb);}else if(cb){if(!y[ab].contains(fb))y[ab].push(fb);}else{var gb=y[ab].indexOf(fb);if(gb!==-1)y[ab].splice(gb,1);}if(db)ma(ab,fb,eb);}function ta(ab,bb){x[ab]=bb;g.inform('SubscriptionLevelUpdated',{profile_id:ab,level:bb});}function ua(ab,bb,cb,db){var eb='/ajax/feed/filter_action/',fb=oa(bb),gb={actor_id:ab,app_id:fb};if(cb){qa(bb);eb+='resubscribe_user_app/';gb.action='resubscribe_user_app';if(!ea[ab])ea[ab]={};ea[ab][fb]=true;}else{ra(bb);eb+='unsubscribe_user_app_checkbox/';gb.action='unsubscribe_user_app_checkbox';if(ea[ab])ea[ab][fb]=false;}new h().setURI(eb).setData(gb).send();}function va(ab,bb,cb,db,eb){var fb=j.scry(ab,'.SubscriptionMenuLevel'),gb=null;fb.forEach(function(hb){if(oa(hb)==cb){gb=hb;}else if(l.isItemChecked(hb))sa(bb,hb,false,false);});gb&&sa(bb,gb,true,db,eb);}function wa(ab,bb,cb){t[bb]=cb;i.conditionClass(ab,'isUnsubscribed',!cb);var db=j.scry(ab,'li.SubscribeMenuSubscribeCheckbox');if(db.length!==0){var eb=db[0];if(cb){qa(eb);}else ra(eb);}}function xa(ab,bb){i.conditionClass(ab,'subscriptionMenuOpen',bb);}function ya(ab,bb,cb){var db=j.find(ab,".FriendListSubscriptionsMenu"),eb=j.find(db,".uiMenuInner");if(fa!=null)fa.forEach(function(fb){eb.removeChild(fb);});cb.forEach(function(fb){eb.appendChild(fb);});fa=cb;}g.subscribe('UnfollowUser',function(ab,bb){if(z[bb.profile_id]){ta(bb.profile_id,z[bb.profile_id]);y[bb.profile_id]=aa[bb.profile_id].slice();}});g.subscribe('UpdateSubscriptionLevel',function(ab,bb){var cb=bb.profile_id+'',db=bb.level+'';ta(cb,db);var eb;for(eb in r)if(r[eb]===cb){var fb=k(eb);fb&&va(fb,cb,db,false);}});var za={init:function(ab,bb,cb){var db=j.getID(ab);if(!r[db])Event.listen(ab,'click',function(eb){return ha(ab,r[db],cb,eb.getTarget());});if(cb===p&&da[bb].length)ya(ab,bb,da[bb]);if(x[bb])na(ab,bb);r[db]=bb;i.conditionClass(ab,'NonFriendSubscriptionMenu',!s[bb]);i.conditionClass(ab,'cannotSubscribe',!u[bb]);i.conditionClass(ab,'noSubscriptionLevels',v[bb]&&!w[bb]);i.conditionClass(ab,'noSubscribeCheckbox',!s[bb]&&!v[bb]);wa(ab,bb,t[bb]);g.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(eb,fb){wa(ab,bb,true);}.bind(this));g.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(eb,fb){g.inform('SubMenu/Reset');wa(ab,bb,false);}.bind(this));xa(ab,false);},getSubscriptions:function(ab){return {level:x[ab],custom_categories:y[ab]};},setSubscriptions:function(ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb){ta(ab,gb+'');s[ab]=bb;t[ab]=cb;u[ab]=db;v[ab]=eb;w[ab]=fb;z[ab]=ib+'';y[ab]=hb.map(String);aa[ab]=jb.map(String);da[ab]=kb;}};e.exports=a.EditSubscriptions||za;});
__d("DynamicFriendListEducation",["event-extensions","Arbiter","AsyncRequest","Dialog","PageTransitions","createArrayFrom"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Dialog'),j=b('PageTransitions'),k=b('createArrayFrom'),l,m,n,o,p,q;function r(){n&&n.hide();o&&o.hide();}function s(v){m.remove(v);r();p({accept_tag_education:true});}function t(){r();p({nux_cancel:true});}var u={init:function(v,w){l=v;m=k(w).map(String);j.registerHandler(function(){r();l=false;p=undefined;m=[];});},showDialog:function(v,w,x){if(l&&m.contains(v)){r();g.inform('DynamicFriendListEducation/dialogOpen',{uid:w,flid:v});p=x;n=new i().setAsync(new h('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true)).setHandler(s.bind(this,v)).setCloseHandler(function(){g.inform('DynamicFriendListEducation/dialogClosed',{uid:w,flid:v});}).setCancelHandler(function(){g.inform('DynamicFriendListEducation/dialogCancel',{uid:w,flid:v});}).show();}else x();},showContextualDialog:function(v,w,x,y){if(l&&m.contains(v)){r();q=x;p=y;new h('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true).send();}else y();},setContextualDialog:function(v,w,x,y){o=v;o.setContext(q);o.show();Event.listen(w,'click',s.bind(this,y));Event.listen(x,'click',t);}};e.exports=u;});
__d("FriendStatus",["array-extensions","function-extensions","Arbiter","AsyncRequest","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){b('array-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('copyProperties'),j=b('createArrayFrom');function k(o,p,q){this.id=o;this.update(p,q);}i(k.prototype,{update:function(o,p){o&&(this.status=o);if(p){this.lists=j(p).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(o){if(this.lists&&!this.lists.contains(o))this.lists.push(o);this._informListChange();},removeFromList:function(o){if(this.lists){var p=this.lists.indexOf(o);p!==-1&&this.lists.splice(p,1);}this._informListChange();},updateList:function(o,p){p?this.addToList(o):this.removeFromList(o);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});i(k,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var l={},m={};function n(o,p,q){if(!l[q.uid]){l[q.uid]=new k(q.uid,o);}else l[q.uid].update(o);g.inform('FriendRequest/change',{uid:q.uid,status:o});}g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],n.curry(k.CAN_REQUEST));g.subscribe(['FriendRequest/confirmFail'],n.curry(k.INCOMING_REQUEST));g.subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],n.curry(k.OUTGOING_REQUEST));g.subscribe(['FriendRequest/confirm','FriendRequest/confirming'],n.curry(k.ARE_FRIENDS));i(k,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(o,p){if(l[o]&&l[o].isComplete()){p(l[o]);}else if(m[o]){m[o].push(p);}else{m[o]=[p];new h().setURI("/ajax/friends/status.php").setData({friend:o}).setHandler(function(q){var r=q.getPayload();k.initFriend.bind(k,o,r.status,r.lists).defer();}).send();}},initFriend:function(o,p,q){var r=l[o]||new k(o);r.update(r.status||p,r.lists||q);l[o]=r;m[o]&&m[o].forEach(function(s){s(r);});m[o]=null;},setSpecialLists:function(o){k.CLOSE_FRIENDS=o.close+'';k.ACQUAINTANCES=o.acq+'';}});e.exports=k;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","FriendStatus","Menu","Parent","ScrollableArea","URI","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('FriendStatus'),n=b('Menu'),o=b('Parent'),p=b('ScrollableArea'),q=b('URI'),r=b('$'),s=b('copyProperties'),t=b('ge'),u=5,v={},w="/ajax/profile/removefriendconfirm.php",x='/ajax/friends/requests/cancel.php',y='/ajax/friend_suggester_dialog.php',z;function aa(ja,ka,la){var ma=v[ja.id],na=function(oa){var pa={action:la?'add_list':'del_list',to_friend:ma.id,friendlists:[ka],source:z};if(oa)s(pa,oa);ma.updateList(ka,la);var qa;if(la&&ka==m.CLOSE_FRIENDS){qa=da(ja,m.ACQUAINTANCES);if(n.isItemChecked(qa)){n.toggleItem(qa);aa(ja,m.ACQUAINTANCES,false);}}else if(la&&ka==m.ACQUAINTANCES){qa=da(ja,m.CLOSE_FRIENDS);if(n.isItemChecked(qa)){n.toggleItem(qa);aa(ja,m.CLOSE_FRIENDS,false);}}var ra={flid:ka,uid:ma.id},sa=la?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(sa,ra);new h().setURI('/ajax/add_friend/action.php').setData(pa).send();};if(la){k.showDialog(ka,ma.id,na);}else na();}function ba(ja){var ka=j.scry(ja,'input')[0];return ka&&ka.value;}function ca(ja,ka,la){var ma={uid:ka.id};new h().setURI(x).setMethod('POST').setData({friend:ka.id}).setHandler(g.inform.bind(g,'FriendRequest/cancel',ma)).setErrorHandler(g.inform.bind(g,'FriendRequest/cancelFail',ma)).setStatusElement(la).send();}function da(ja,ka){var la=n.getItems(ja);for(var ma=0;ma<la.length;ma++)if(ba(la[ma])==ka)return la[ma];return null;}function ea(ja,ka){var la=n.getItems(ja);la.forEach(function(ma){var na=ba(ma),oa=ka.lists.contains(na);if(n.isItemChecked(ma)!==oa)n.toggleItem(ma);});}function fa(ja){var ka=n.getItems(ja),la=!i.hasClass(ja,'followButtonFlyout')&&!i.hasClass(ja,'likeButtonFlyout'),ma=[],na=[],oa=0,pa=0;ka.forEach(function(ua){if(i.hasClass(ua,'neverHide')){i.removeClass(ua,'underShowMore');oa++;}else if(n.isItemChecked(ua)){ma.push(ua);}else if(i.hasClass(ua,'neverShow')||i.hasClass(ua,'FriendListCreateTrigger')||(!la&&i.hasClass(ua,'friendOptionsOnly'))){i.addClass(ua,'underShowMore');pa++;}else na.push(ua);});var qa=u-oa,ra=ma.concat(na),sa=pa;ra.forEach(function(ua){if(i.hasClass(ua,'ShowMoreItem')){qa--;return;}if(qa){i.removeClass(ua,'underShowMore');qa--;}else{i.addClass(ua,'underShowMore');sa=true;}});i.conditionClass(ja,'hasMoreFriendListItems',sa);var ta=j.scry(ja,'.FriendListMenuShowMore');ta.forEach(function(ua){i.removeClass(ua,'FriendListMenuShowMore');});}function ga(ja,ka){var la=j.scry(ja,'.FriendListUnfriend')[0],ma=j.scry(ja,'.FriendListCancel')[0],na=j.scry(ja,'.FriendListSuggestFriends')[0];if(ma)i.conditionShow(ma,ka.status==m.OUTGOING_REQUEST);if(la){i.conditionShow(la,ka.status==m.ARE_FRIENDS);j.find(la,'a').setAttribute('ajaxify',q(w).addQueryData({uid:ka.id}).toString());}if(na)j.find(na,'a').setAttribute('href',q(y).addQueryData({newcomer:ka.id,ref:'profile_others_dropdown',close_handler:'null'}).toString());}function ha(ja,ka){var la=j.scry(ja,'div.FriendListSubscriptionsMenu');if(la.length!==0)l.init(ja,ka,45);}g.subscribe('FriendRequest/change',function(ja,ka){for(var la in v){var ma=t(la),na=v[la];if(ma&&na&&na.id==ka.uid){ea(ma,na);ga(ma,na);fa(ma);}}});n.subscribe('select',function(ja,ka){if(i.hasClass(ka.item,'ShowMoreItem')&&i.hasClass(ka.menu,'FriendListMenu')){i.addClass(ka.menu,'FriendListMenuShowMore');p.poke(ka.item);}});var ia={init:function(ja,ka,la){ja=r(ja);z=la;if(!v[ja.id])n.subscribe('select',function(ma,na){if(j.contains(ja,na.item))if(o.byClass(na.item,'FriendListItem')){n.toggleItem(na.item);var oa=ba(na.item);aa(ja,oa,n.isItemChecked(na.item));}else if(o.byClass(na.item,'FriendListCancel')){ca(ja,v[ja.id],na.item);}else if(o.byClass(na.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ja,'async_saving');m.getFriend(ka,function(ma){ea(ja,ma);ga(ja,ma);v[ja.id]=ma;fa(ja);ha(ja,ka);i.removeClass(ja,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||ia;});
__d("FriendListFlyoutController",["event-extensions","Arbiter","AsyncRequest","Button","CSS","DataStore","Dialog","DOM","FriendEditLists","FriendStatus","Layer","Parent","ScrollableArea","Style","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Button'),j=b('CSS'),k=b('DataStore'),l=b('Dialog'),m=b('DOM'),n=b('FriendEditLists'),o=b('FriendStatus'),p=b('Layer'),q=b('Parent'),r=b('ScrollableArea'),s=b('Style'),t=b('UserAgent'),u,v,w=null,x=null,y,z,aa,ba,ca,da,ea=1500,fa={init:function(sa){fa.init=bagofholding;u=sa;u.subscribe('mouseenter',ga);u.subscribe('mouseleave',na);u.subscribe('hide',ha);if(w)m.setContent(u.getContent(),[w,x]);var ta=function(ua){var va=q.byClass(ua.getTarget(),'enableFriendListFlyout');if(va)if(y===va){clearTimeout(ba);}else{v&&pa();ma(va);}};Event.listen(document.documentElement,{mouseover:ta,click:ta});g.subscribe('FriendEditLists/unfriend',pa);g.subscribe('DynamicFriendListEducation/dialogOpen',function(){da=true;});g.subscribe('DynamicFriendListEducation/dialogClosed',function(){da=false;na();});},initContent:function(sa){m.appendContent(document.body,sa);(function(){if(!w){w=sa;u&&m.setContent(u.getContent(),[w,x]);j.show(w);Event.listen(w,'click',qa);v&&ka(y);}else{m.remove(sa);sa=null;}}).defer();},initNux:function(sa){if(x)return;x=sa;u&&m.setContent(u.getContent(),[w,x]);},show:function(sa){la(sa);},hide:function(sa){sa===false?pa():na();},setActiveNode:function(sa){v&&pa();y=sa;z=Event.listen(sa,'mouseleave',function(){y=null;z&&z.remove();});},setCloseListener:function(sa,ta){k.set(sa,'flfcloselistener',ta);if(y!=sa)k.set(sa,'flfcloselistenertimeout',ra.curry(sa).defer(ea));},setCloseListenerTimeout:function(sa){ea=sa;}};function ga(){clearTimeout(ba);}function ha(){if(y){j.removeClass(y,'selected');j.removeClass(y,'uiButtonHover');if(k.get(y,'flfcloselistener')){var sa=y;k.set(y,'flfcloselistenertimeout',ra.curry(sa).defer(ea));}}v=false;ja();y=null;}function ia(sa){if(m.isNodeOfType(sa,'label')&&j.hasClass(sa,'uiButton'))sa=i.getInputElement(sa);return k.get(sa,'profileid');}function ja(){z&&z.remove();z=null;ca&&p.unsubscribe(ca);ca=null;ba&&clearTimeout(ba);ba=null;}function ka(sa){var ta=ia(sa),ua=k.get(sa,'flloc');n.init(w,ta,ua);j.conditionClass(w,'followButtonFlyout',j.hasClass(sa,'profileFollowButton'));j.conditionClass(w,'friendButtonFlyout',j.hasClass(sa,'FriendRequestFriends')||j.hasClass(sa,'FriendRequestIncoming')||j.hasClass(sa,'FriendRequestOutgoing'));j.conditionClass(w,'likeButtonFlyout',j.hasClass(sa,'profileLikeButton'));var va=m.scry(w,'div.uiScrollableArea')[0];va&&r.poke(va);}function la(sa){if(!u||v)return;u.setContext(sa);u.setCausalElement(sa);sa.setAttribute('aria-expanded','true');j.addClass(sa,'selected');j.addClass(sa,'uiButtonHover');u.setFixed(s.isFixed(sa)).show();y=sa;v=true;if(w){ka(sa);}else new h().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(u.getContent()).send();ja();z=Event.listen(sa,'mouseleave',na);ca=p.subscribe('show',pa);if(k.get(sa,'flfcloselistener'))clearTimeout(k.remove(sa,'flfcloselistenertimeout'));var ta=ia(sa);o.getFriend(ta,function(ua){if(!x)return;if(ua.status==o.OUTGOING_REQUEST){j.show(x);h.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else j.hide(x);});}function ma(sa){y=sa;aa=la.curry(sa).defer(350);z=Event.listen(sa,'mouseleave',function(){clearTimeout(aa);y=null;z&&z.remove();});}function na(){ba=pa.defer(150);}function oa(){var sa=l.getCurrent(),ta=sa&&sa.getBody();return !!(ta&&m.scry(ta,'.friendListDialogTourCarousel')[0]);}function pa(){if(da||oa())return;t.ie()<8&&document.documentElement.focus();if(u){u.hide();var sa=u.getCausalElement();sa&&sa.setAttribute('aria-expanded','false');}}function qa(event){var sa=q.byTag(event.getTarget(),'a');if(sa&&j.hasClass(sa,'FriendListActionItem'))na();}function ra(sa){var ta=k.remove(sa,'flfcloselistener');ta&&ta();}e.exports=a.FriendListFlyoutController||fa;});
__d("legacy:FriendListFlyoutController",["FriendListFlyoutController"],function(a,b,c,d){a.FriendListFlyoutController=b('FriendListFlyoutController');},3);
__d("legacy:FriendStatus",["FriendStatus"],function(a,b,c,d){a.FriendStatus=b('FriendStatus');},3);
__d("legacy:dom-collect",["collectDataAttributes"],function(a,b,c,d){a.collect_data_attribs=b('collectDataAttributes');},3);
var AddFriendButton={ERROR_ALREADY_ADDED:1431005,init:function(a,b,c,d,e,f,g,h,i,j,k){var l=null,m=DOM.scry(a,'.addButton')[0],n=DOM.scry(a,'.outgoingButton')[0],o=DOM.scry(a,'.incomingButton')[0],p=DOM.scry(a,'.friendButton')[0];function q(v,w,x){var y=new URI(m.getAttribute('ajaxify'));link_data=collect_data_attribs(a,['ft','gt']);new AsyncRequest().setURI(f).setData({to_friend:b,action:v,how_found:d,ref_param:e,link_data:link_data,outgoing_id:n.id,xids:y.getQueryData().xids,logging_location:g,no_flyout_on_click:h,ego_log_data:i,http_referer:k}).setErrorHandler(w).setServerDialogCancelHandler(x).setRelativeTo(n).send();}function r(v,w){m&&CSS.hide(m);n&&CSS.hide(n);o&&CSS.hide(o);p&&CSS.hide(p);if(v)CSS.show(v);if('Outgoing'==w&&l!=w&&j)animation(v).from('backgroundColor','#FFF8CC').to('backgroundColor','transparent').from('borderColor','#FFE222').to('borderColor',CSS.getStyle(v,'borderLeftColor')).duration(2000).go();l&&CSS.removeClass(a,'fStatus'+l);l=w;CSS.addClass(a,'fStatus'+w);}function s(v){if(CSS.hasClass(v,'enableFriendListFlyout')){FriendListFlyoutController.show(v);}else FriendListFlyoutController.hide();}var t=Arbiter.subscribe('FriendRequest/change',function(v,w){if(w.uid!=b)return;switch(w.status){case FriendStatus.ARE_FRIENDS:return r(p,'Friends');case FriendStatus.INCOMING_REQUEST:return r(o,'Incoming');case FriendStatus.OUTGOING_REQUEST:return r(n,'Outgoing');case FriendStatus.CAN_REQUEST:return r(m,'Requestable');}}),u;if(c)u=Arbiter.subscribe('FriendRequest/confirm',function(v,w){w.uid==b&&goURI(c);});m&&Event.listen(m,'click',function(){Arbiter.inform('FriendRequest/sending',{uid:b});if(h){FriendListFlyoutController.setActiveNode(n);}else s(n);q("add_friend",function(v){var w=v.error==AddFriendButton.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';Arbiter.inform(w,{uid:b});FriendListFlyoutController.hide();AsyncResponse.defaultErrorHandler(v);},function(v){Arbiter.inform('FriendRequest/sendFail',{uid:b});FriendListFlyoutController.hide();});});PageTransitions.registerHandler(function(){t.unsubscribe();u&&u.unsubscribe();});}};
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
__d("RespondToRequestButton",["event-extensions","Arbiter","CSS","Menu"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('Menu'),j={init:function(k,l,m,n){Event.listen(l,'click',function(){h.addClass(l,'uiButtonConfirm');h.addClass(l,'selected');m.show();});m.subscribe('hide',function(){h.removeClass(l,'uiButtonConfirm');h.removeClass(l,'selected');});i.subscribe('select',function(o,p){if(!h.hasClass(p.menu,'requestResponseMenu'))return;if(p.item.firstChild.getAttribute('data-profileid')!=k)return;if(h.hasClass(p.item,'reject')){h.hide(l);h.show(n);}m.hide();g.inform('FriendRequest/delete');});}};e.exports=j;});
__d("legacy:RespondToRequestButton",["RespondToRequestButton"],function(a,b,c,d){a.RespondToRequestButton=b('RespondToRequestButton');},3);
var FriendButtonIcon={init:function(a,b,c){var d=DOM.find(b,'.defaultIcon'),e=DOM.find(b,'.closeIcon'),f=DOM.find(b,'.acqIcon');Arbiter.subscribe('FriendListMembershipChange',function(g,h){if(h.uid==c){var i=h.lists.contains(FriendStatus.CLOSE_FRIENDS),j=h.lists.contains(FriendStatus.ACQUAINTANCES);if(i&&!j){Button.setIcon(a,e);}else if(j&&!i){Button.setIcon(a,f);}else Button.setIcon(a,d);}});}};
var PageLikeButton=window.PageLikeButton||(function(){function a(b,c,d,e,f){fbpage_set_fan_status(b,c,d,false,function(){Arbiter.inform(PageLikeButton.LIKED_SUCCESS,{profile_id:c});},e,{fan_origin:f});}return {LIKED:'liked',UNLIKED:'unliked',LIKED_SUCCESS:'liked_success',init:function(b,c,d,e,f,g){Arbiter.subscribe(PageLikeButton.LIKED,function(h,i){if(e===i.profile_id)b.swap();});Arbiter.subscribe(PageLikeButton.UNLIKED,function(h,i){if(e===i.profile_id){b.unswap();d.hideFlyout();}});if(g)Arbiter.subscribe(PageLikeButton.LIKED_SUCCESS,function(h,i){app_data=URI.getRequestURI().getQueryData().app_data;if(i.profile_id==e)new AsyncRequest().setURI('/ajax/pages/fetch_app_column.php').setData({profile_id:e,tab_key:g,app_data:app_data}).send();});Event.listen(c,'click',function(event){a(event.getTarget(),e,true,function(){Arbiter.inform(PageLikeButton.UNLIKED,{profile_id:e});},f);Arbiter.inform(PageLikeButton.LIKED,{profile_id:e});});},initUnlike:function(b,c,d){Event.listen(b,'click',function(event){a(event.getTarget(),c,false,function(){Arbiter.inform(PageLikeButton.LIKED,{profile_id:c});},d);Arbiter.inform.bind(Arbiter,PageLikeButton.UNLIKED,{profile_id:c}).defer();});}};})();
__d("SwapButton",["event-extensions","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('CSS');function i(j,k,l){this._swapperButton=j;this._swappeeButton=k;Event.listen(j,'click',this.swap.bind(this));if(l)Event.listen(k,'click',this.unswap.bind(this));}g(i.prototype,{_swapperButton:null,_swappeeButton:null,swap:function(){h.hide(this._swapperButton);h.show(this._swappeeButton);},unswap:function(){h.show(this._swapperButton);h.hide(this._swappeeButton);}});e.exports=i;});
__d("HoverButton",["AsyncRequest","CSS","DOM","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('URI'),k=b('copyProperties');function l(m,n,o,p){this._button=m;this._flyout=n;this._flyoutAjaxify=p;this._flyoutContent=o;n.subscribe('show',this._onShow.bind(this));n.subscribe('hide',this._onHide.bind(this));}k(l.prototype,{_button:null,_flyout:null,_flyoutAjaxify:null,_flyoutContent:null,showFlyoutBriefly:function(){this.showFlyout();this._flyout.hideFlyoutDelayed(5000);},showFlyout:function(){this._flyout.showFlyout(this._button,true);this._flyout.inform('show',this._button);},hideFlyout:function(){this._flyout.hideFlyout(true);this._flyout.inform('hide',this._button);},_onShow:function(m,n){h.addClass(n,'uiHoverButtonSelected');h.addClass(n,'selected');if(this._flyoutAjaxify){h.addClass(this._flyoutContent,'async_saving');new g().setURI(new j(this._flyoutAjaxify)).setHandler(function(o){h.removeClass(this._flyoutContent,'async_saving');i.setContent(this._flyoutContent,o.payload);}.bind(this)).send();this._flyoutAjaxify=null;}},_onHide:function(m,n){h.removeClass(n,'uiHoverButtonSelected');h.removeClass(n,'selected');},destroy:function(){this.hideFlyout();this._flyout.destroy();}});e.exports=l;});
__d("HoverFlyout",["event-extensions","ArbiterMixin","Class","DataStore","LayerDestroyOnHide","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('DataStore'),j=b('LayerDestroyOnHide'),k=b('copyProperties');function l(m,n,o,p){if(m){this._showDelay=o;this._hideDelay=p;this.init(m);if(n)this.initNode(n);}}k(l.prototype,g,{init:function(m){this._flyout=m;this._showDelay=this._showDelay||0;this._hideDelay=this._hideDelay||100;this._showTimeout=null;this._hideTimeout=null;this._flyoutSubscriptions=[this._flyout.subscribe('mouseenter',this._onFlyoutMouseEnter.bind(this)),this._flyout.subscribe('mouseleave',this.hideFlyout.shield(this))];this._nodes=[];this._dataStoreUnique='HoverFlyout_'+Date.now()+'_listeners';this._flyout.disableBehavior(j);return this;},initNode:function(m){if(this._nodes.contains(m))return this;this._nodes.push(m);i.set(m,this._dataStoreUnique,[Event.listen(m,'mouseenter',this._onNodeMouseEnter.bind(this,m)),Event.listen(m,'mouseleave',this.hideFlyout.shield(this))]);return this;},deactivateNode:function(m){var n=i.get(m,this._dataStoreUnique);if(n)while(n.length)n.pop().remove();this._nodes.remove(m);},setShowDelay:function(m){this._showDelay=m;return this;},setHideDelay:function(m){this._hideDelay=m;return this;},showFlyout:function(m,n){this.setActiveNode(m);if(n){this._flyout.setContext(m).show();this.inform('show',m);}else this._showTimeout=this.showFlyout.bind(this,m,true).defer(this._showDelay);return this;},hideFlyout:function(m){clearTimeout(this._showTimeout);if(m){this._flyout.hide();this._activeNode&&this.inform('hide',this._activeNode);this._activeNode=null;}else this._hideTimeout=this.hideFlyout.bind(this,true).defer(this._hideDelay);},hideFlyoutDelayed:function(m){clearTimeout(this._showTimeout);clearTimeout(this._hideTimeout);this._hideTimeout=this.hideFlyout.bind(this,true).defer(m);},getActiveNode:function(){return this._activeNode;},setActiveNode:function(m){clearTimeout(this._hideTimeout);if(this._activeNode&&this._activeNode!==m)this.hideFlyout(true);this._activeNode=m;return this;},clearNodes:function(){for(var m=this._nodes.length;m>0;m--)this.deactivateNode(this._nodes[m-1]);},destroy:function(){while(this._flyoutSubscriptions.length)this._flyout.unsubscribe(this._flyoutSubscriptions.pop());this.clearNodes();},_onNodeMouseEnter:function(m){if(this._activeNode===m){clearTimeout(this._hideTimeout);}else this.showFlyout(m);},_onFlyoutMouseEnter:function(){clearTimeout(this._hideTimeout);}});e.exports=a.HoverFlyout||l;});
__d("StickyController",["event-extensions","CSS","Style","Vector","copyProperties","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('Style'),i=b('Vector'),j=b('copyProperties'),k=b('throttle');function l(m,n,o,p){this._element=m;this._marginTop=n;this._onchange=o;this._proxy=p||m.parentNode;}j(l.prototype,{handleScroll:function(){var m=i.getElementPosition(this._proxy,'viewport').y<=this._marginTop;if(this.isFixed()!==m){h.set(this._element,'top',m?this._marginTop+'px':'');g.conditionClass(this._element,'fixed_elem',m);this._onchange&&this._onchange(m);}},start:function(){if(this._event)return;this._event=Event.listen(window,'scroll',k(this.handleScroll,100,this));this.handleScroll.bind(this).defer();},stop:function(){this._event&&this._event.remove();this._event=null;},isFixed:function(){return g.hasClass(this._element,'fixed_elem');}});e.exports=l;});
__d("legacy:StickyController",["StickyController"],function(a,b,c,d){a.StickyController=b('StickyController');},3);
function fbpage_set_fan_status(a,b,c,d,e,f,g){e=e?e:function(j){_fbpage_show_change_status_feedback(a,j.getPayload());};var h={fbpage_id:b,add:c,reload:d};if(g!=null)copy_properties(h,g);var i=new AsyncRequest().setURI('/ajax/pages/fan_status.php').setData(h).setNectarModuleDataSafe(a).setHandler(e);if(f)i.setErrorHandler(f);i.send();return false;}function fbpage_set_favorite_status(a,b,c){var d=function(){_fbpage_show_change_status_feedback(a,this.getUserData());},e={fbpage_id:b,add:c},f=new AsyncRequest().setMethod('POST').setURI('/ajax/pages/favorite_status.php').setData(e);new Dialog().setAsync(f).setCloseHandler(d).show();return false;}function _fbpage_show_change_status_feedback(a,b){if(!b||!a)return;if(b.reload){fbpage_reload_on_fan_status_changed(b.preserve_tab);}else fbpage_redraw_on_fan_status_changed(a,b.feedback);}function fbpage_reload_on_fan_status_changed(a){var b=URI.getRequestURI();if(a){var c=FutureSideNav.getInstance().selected.textKey;if(!b.getQueryData().sk&&c)b.addQueryData({sk:c});}window.location.href=b;}function fbpage_redraw_on_fan_status_changed(a,b){if(!b)return;if(Parent.byClass(a,'fbTimelineEscapeSectionItem'))a=Parent.byClass(a,'fan_status_inactive')||a;var c=DOM.create('span',{className:'fan_status_inactive'},b);a.parentNode.replaceChild(c,a);var d=function(){if(data.can_repeat_action)c.parentNode.replaceChild(a,c);};animation(c).duration(3000).checkpoint().to('backgroundColor','#FFFFFF').duration(1000).ondone(d).go();}function fbpage_toggle_like_on_fan_status_changed(a,b){var c=$('liked_pages_like_action_'+a),d=$('liked_pages_undo_action_'+a);CSS.conditionClass(c,'hidden_elem',b);CSS.conditionClass(d,'hidden_elem',!b);}
__d("TimelineConstants",[],function(a,b,c,d,e,f){var g={DS_HEIGHT:'timeline-unit-height',DS_LOADED:'timeline-capsule-loaded',DS_SIDEORG:'timeline-unit-sideorg',DS_TAILBALANCE:'timeline-capsule-tailbalance',DS_COLUMN_HEIGHT_DIFFERENTIAL:'timeline-column-diff-height',FIXED_SIDE_LEFT:'left',FIXED_SIDE_RIGHT:'right',FIXED_SIDE_BOTH:'both',SCROLL_TO_OFFSET:30,SUBSECTION_SCROLL_TO_OFFSET:90};e.exports=g;});
__d("TimelineURI",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={TIMELINE_KEY:'timeline',WALL_KEY:'wall',parseURI:function(i){i=g(i);var j=i.getQueryData(),k=i.getPath(),l=k.split('/').slice(1);if(l[0]=='people'||l[0]=='pages')l=l.slice(2);var m=j.sk||l[1]||h.TIMELINE_KEY;if(m==h.WALL_KEY)m=h.TIMELINE_KEY;var n=null,o=null;if(m==h.TIMELINE_KEY){o=parseInt(l[2],10)||null;n=parseInt(l[3],10)||null;}return {path:k,id:j.id||l[0],key:m,viewas:j.viewas?j.viewas:0,filter:j.filter?j.filter:null,year:o,month:n,friendship:!!j.and};}};e.exports=h;});
__d("TimelineController",["event-extensions","Arbiter","CSS","DataStore","DOM","Run","ScrollingPager","Style","TimelineConstants","TimelineURI","Vector","ViewportBounds","$","ge","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('Run'),l=b('ScrollingPager'),m=b('Style'),n=b('TimelineConstants'),o=b('TimelineURI'),p=b('Vector'),q=b('ViewportBounds'),r=b('$'),s=b('ge'),t=b('throttle'),u=484,v=48,w=740,x=1285,y=null,z=false,aa,ba,ca,da={},ea={},fa=[],ga=null,ha=0,ia=false,ja=false,ka=false,la={allactivity:true,approve:true,games:true,map:true,music:true,video:true};la[o.TIMELINE_KEY]=true;var ma=[],na=false;function oa(xa,ya,za){za=za||[];if(da[xa])return da[xa][ya].apply(da[xa],za);ea[xa]=ea[xa]||{};ea[xa][ya]=za;return false;}function pa(){if(!(ia||ka||ja)){ga.remove();ga=null;return;}var xa=p.getScrollPosition();ia=ia&&ra(r('rightCol'),xa,'paddingTop',true);ja=ja&&ra(r('pagelet_above_header_timeline'),xa,'top');ka=ka&&ra(r('blueBar'),xa,'paddingTop');}function qa(){var xa=p.getScrollPosition(),ya=ha===0||xa.y>=ha;oa(wa.STICKY_HEADER,'toggle',[ya]);oa(wa.CONTENT,'checkCurrentSectionChange');}function ra(xa,ya,za,ab){if(ya.y<=0){sa(xa,za);return false;}else{var bb=ab&&wa.getCurrentScrubber();if((bb&&h.hasClass(bb.getRoot(),'fixed_elem'))||m.isFixed(s('pagelet_timeline_friends'))){sa(xa,za);return false;}else{var cb=parseInt(xa.style[za],10)||0;if(ya.y<cb){h.addClass(xa,'timeline_fixed');xa.style[za]=ya.y+'px';}else h.removeClass(xa,'timeline_fixed');}}return true;}function sa(xa,ya){xa.style[ya]='0px';h.removeClass(xa,'timeline_fixed');}function ta(){oa(wa.ADS,'adjustAdsType',[wa.shouldShowWideAds()]);oa(wa.ADS,'adjustAdsToFit');oa(wa.CONTENT,'adjustContentPadding');oa(wa.STICKY_HEADER_NAV,'adjustMenuHeights');}function ua(xa,ya){if(xa=='sidebar/initialized')na=true;oa(wa.ADS,'adjustAdsType',[wa.shouldShowWideAds()]);}function va(){while(fa.length)fa.pop().remove();for(var xa in da)da[xa].reset&&da[xa].reset();ga&&ga.remove();ga=null;ca.unsubscribe();ca=null;y=null;aa=null;da={};ea={};ha=0;ja=false;if(ia){r('rightCol').style.paddingTop='';h.removeClass(r('rightCol'),'timeline_fixed');}ia=false;if(ka){r('blueBar').style.paddingTop='';h.removeClass(r('blueBar'),'timeline_fixed');}ka=false;ma=[];na=false;z=false;i.purge(n.DS_HEIGHT);i.purge(n.DS_LOADED);i.purge(n.DS_SIDEORG);i.purge(n.DS_TAILBALANCE);i.purge(n.DS_COLUMN_HEIGHT_DIFFERENTIAL);}var wa={NAV:'nav',STICKY_HEADER:'sticky_header',STICKY_HEADER_NAV:'sticky_header_nav',SCRUBBER:'scrubber',CONTENT:'content',ADS:'ads',COVER:'cover',LOGGING:'logging',SECTION_LOADING:'TimelineController/sectionLoading',SECTION_LOADED:'TimelineController/sectionLoaded',SECTION_FULLY_LOADED:'TimelineController/sectionFullyLoaded',SECTION_REGISTERED:'TimelineController/sectionRegistered',SCRUBBER_DEFAULT_OFFSET:38,init:function(xa,ya,za){if(z)return;if(ya==o.WALL_KEY)ya=o.TIMELINE_KEY;z=true;aa=xa;ba=za.has_fixed_ads;oa(wa.CONTENT,'adjustContentPadding');fa.push(Event.listen(window,'scroll',t(qa,100)),Event.listen(window,'resize',t(ta,100)));ca=g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide'],ua);k.onLeave(va);wa.registerCurrentKey(ya);},setAdsTracking:function(xa){oa(wa.ADS,'start',[xa]);},coverHasExpanded:function(xa){r('rightCol').style.paddingTop=xa+'px';ia=true;var ya=r('pagelet_above_header_timeline');if(ya.firstChild){r('above_header_timeline_placeholder').style.height=ya.offsetHeight+'px';ya.style.top=xa+'px';ja=true;}var za=document.documentElement;ka=za.clientHeight<400||za.clientWidth<za.scrollWidth;if(ka)r('blueBar').style.paddingTop=xa+'px';ga=Event.listen(window,'scroll',pa);},pageHasScrubber:function(xa){return !xa||xa.match(/^(og_)?app_/)||(xa in la);},fixedAds:function(){return ba;},registerCurrentKey:function(xa){y=xa;var ya=p.getViewportDimensions().y<w;oa(wa.ADS,'setShortMode',[ya,xa]);oa(wa.ADS,'updateCurrentKey',[xa]);ha=xa==o.TIMELINE_KEY?u-v:0;},getCurrentKey:function(){return y;},getSectionKeys:function(){return ma;},getCurrentScrubber:function(){return da[wa.SCRUBBER];},getCurrentStickyHeaderNav:function(){return da[wa.STICKY_HEADER_NAV];},getSection:function(xa){return oa(wa.CONTENT,'getSection',[xa]);},scrubberHasLoaded:function(xa){oa(wa.STICKY_HEADER_NAV,'addTimePeriods',[ma]);oa(wa.ADS,'registerScrubber',[xa]);},registerSectionKey:function(xa,ya){if(da[wa.STICKY_HEADER_NAV]){oa(wa.STICKY_HEADER_NAV,'addTimePeriod',[xa]);}else ma[ya]=xa;},scrubberHasChangedState:function(){oa(wa.ADS,'adjustAdsToFit');},scrubberWasClicked:function(xa){oa(wa.LOGGING,'logScrubberClick',[xa]);},sectionHasChanged:function(xa,ya){oa(wa.STICKY_HEADER_NAV,'updateSection',[xa,ya]);oa(wa.SCRUBBER,'updateSection',[xa,ya]);oa(wa.ADS,'loadAdsFromUserActivity');oa(wa.LOGGING,'logSectionChange',[xa,ya]);},navigateToSection:function(xa){oa(wa.CONTENT,'navigateToSection',[xa]);},shouldShowWideAds:function(){if(!na)return false;var xa=x+q.getRight();return p.getViewportDimensions().x>=xa;},sidebarInitialized:function(){return na;},adjustStickyHeaderWidth:function(){oa(wa.STICKY_HEADER,'adjustWidth');},register:function(xa,ya){da[xa]=ya;if(ea[xa]){for(var za in ea[xa])oa(xa,za,ea[xa][za]);delete ea[xa];}},adjustScrollingPagerBuffer:function(xa,ya){var za=i.get(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,ya);if(!za)return;var ab=l.getInstance(xa);ab&&ab.setBuffer(ab.getBuffer()+Math.abs(za));},runOnceWhenSectionFullyLoaded:function(xa,ya,za){if(oa(wa.CONTENT,'getSection',[ya])){var ab=false;j.scry(da[wa.CONTENT].getSection(ya).node,'ol.fbTimelineCapsule').forEach(function(cb){if(!ab&&i.get(n.DS_LOADED,cb.id)===za){xa();ab=true;}});if(ab)return;}var bb=g.subscribe(wa.SECTION_FULLY_LOADED,function(cb,db){if(db.scrubberKey===ya&&db.pageIndex===za){xa();bb.unsubscribe();}});}};e.exports=wa;});
__d("TimelineSmartInsert",["CSS","DOM","Run","UserAgent","Vector"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Run'),j=b('UserAgent'),k=b('Vector'),l=false,m=false;function n(){if(m)return;i.onLeave(o);m=true;}function o(){l=false;m=false;}var p={BUFFER:100,run:function(q,r){n();if(!l||j.ie()<=8){r();return;}var s=q.offsetHeight;r();var t=q.offsetHeight;if(t-s!==0&&k.getElementPosition(q).y+s<k.getScrollPosition().y+p.BUFFER)window.scrollBy(0,t-s);},enable:function(){l=true;}};e.exports=p;});
__d("legacy:TimelineCapsule",["TimelineCapsule"],function(a,b,c,d){a.TimelineCapsule=b('TimelineCapsule');},3);
__d("legacy:TimelineComposerUtilities",["TimelineComposerUtilities"],function(a,b,c,d){a.TimelineComposerUtilities=b('TimelineComposerUtilities');},3);
__d("legacy:TimelineController",["TimelineController"],function(a,b,c,d){a.TimelineController=b('TimelineController');},3);
__d("TimelineDrag",["event-extensions","ArbiterMixin","Class","Locale","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties');function m(n,o,p){p=p||{};this._listenOn=p.listenOn;this._offsetInput=o;this._defaultOffset=p.default_offset;this._killClicks=p.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(n,p);}l(m.prototype,g,{setPicture:function(n,o){if(!n)return false;o=o||{};this._picture=n;this._defaultOffset=o.default_offset;if(o.vertical!==undefined)this._vertical=o.vertical;if(this._vertical){if(o.height)this._containerHeight=o.height;this._offsetType='top';this._eventCoord='y';}else{if(o.width)this._containerWidth=o.width;this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=Event.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var n=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=Event.listen(n,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.width;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=Event.listen(n,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var n=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=n-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[Event.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),Event.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var n=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=n+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=n;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(n){n.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(n){if(this._RTLXSwitch){n=Math.max(0,Math.min(n,-this._maxOffset));}else n=Math.min(0,Math.max(n,this._maxOffset));j.set(this._picture,this._offsetType,n+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=m;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","Vector","TimelineController","TimelineDrag","Style","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('Vector'),n=b('TimelineController'),o=b('TimelineDrag'),p=b('Style'),q=b('copyProperties'),r=b('ge');function s(){}s.instance=null;s.getInstance=function(){return s.instance;};q(s.prototype,{init:function(t,u,v){this.root=t;this._parentSection=k.byClass(this.root,'fbTimelineSection');this._coverHeight=u;this.cover=i.find(this.root,'.cover');s.instance=this;this.previewing=v;this.editing=false;if(v){this.updateCoverImage(v);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));if(this.previewing)this.editMode();n.register(n.COVER,this);},showLoadingIndicator:function(){var t=r('fbCoverImageContainer');if(t)h.addClass(t,'opaquedLoading');},hideLoadingIndicator:function(){var t=r('fbCoverImageContainer');if(t)h.removeClass(t,'opaquedLoading');},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var t=i.scry(this._coverImage,'.coverWrap')[0];if(t)this._originalOffset=p.get(i.find(t,'.coverPhotoImg'),'top');h.addClass(this._parentSection,'fbEditCover');l.scrollTo(document.body);if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var u=i.scry(this._coverImage,'.coverPhotoImg')[0];if(u)this._createDragger();this.editing=true;},_expandCover:function(t){t-=1;this.cover.style.marginTop='0px';if(t!=m.getScrollPosition().y){window.scrollBy(0,t);n.coverHasExpanded(t);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;i.find(this.root,'input.hiddenVideoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();},_createDragger:function(){this._timelineDrag=new o(i.find(this.root,'.coverImage .coverPhotoImg'),i.find(this.root,'input.photoOffsetInput'),{height:this._coverHeight,listenOn:this.cover,vertical:true,killClicks:true});},updateCoverImage:function(t,u,v){this.videoID=v;if(u)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=t;i.find(this.root,'input.hiddenVideoID').value=v||null;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(u)i.replace(i.find(this.root,'.coverImage'),j(u));if(this._timelineDrag){this._timelineDrag.setPicture(i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'));}else this._createDragger();},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)p.set(i.find(this._coverImage,'.coverPhotoImg'),'top',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];this._exitEditMode();},isInEditMode:function(){return this.editing;}});e.exports=s;});
__d("TimelineFriendsNavHovercard",["event-extensions","Hovercard","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Hovercard'),h=b('UserAgent');function i(event){var k=event.getTarget();g.processNode(k)&&event.stop();}var j={init:function(k){if(h.ie()<7)return;Event.listen(k,'mouseover',i);}};e.exports=j;});
var TimelineLogging=(function(){var a=false,b=0,c=null;return {init:function(d){if(a)return;b=d;TimelineController.register(TimelineController.LOGGING,this);},reset:function(){a=false;b=0;c=null;},log:function(d,e){e.profile_id=b;report_data(d,{gt:e});},logSectionChange:function(d,e){var f={timeline_section_change:1,key:d};if(c&&d==c){f.timeline_scrubber=1;c=null;}TimelineLogging.log('timeline',f);},logScrubberClick:function(d){c=d;}};})();
__d("TimelineNavigation",["event-extensions","Arbiter","DOM","CSS","PageTransitions","Parent","TimelineController","TimelineURI","URI","$","createArrayFrom","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('CSS'),j=b('PageTransitions'),k=b('Parent'),l=b('TimelineController'),m=b('TimelineURI'),n=b('URI'),o=b('$'),p=b('createArrayFrom'),q=b('ge'),r=(function(){var s=4,t=110,u=20,v=119,w=328,x=10,y=3,z=false,aa=21,ba,ca,da,ea=[],fa=[],ga,ha=0,ia,ja=0,ka=0,la,ma=s,na=false,oa=false,pa=null,qa,ra=false,sa,ta,ua=false;function va(ib,jb,kb){if(!jb.firstChild){h.remove(jb);return;}fa.push(jb);ya(kb.recent);i.removeClass(k.byTag(jb,'li'),'empty');if(ga&&(ja>s||ka>0))i.removeClass(ga,'notready');xa();if(kb.async){cb();eb();}}function wa(ib,jb,kb){h.remove(k.byTag(jb,'li'));if(!kb.async){la++;}else{ja--;cb();eb();}xa();}function xa(){var ib=ga?0:aa;if(ja<=s){var jb=w+v*Math.max(0,s-ja)+ib;ia.style.width=jb+'px';ma=ja;za();}}function ya(ib){if(ib){ka++;}else ja++;za();}function za(){if(!sa)return;var ib=Math.max(0,ja-s)+ka;if(ha&&ga){h.setContent(ha,ib===0?" ":ib);i.conditionClass(ga,'fbTimelineMoreButtonZero',ib===0);if(!na)i.conditionShow(ga,ib>0);}}function ab(){var ib=h.scry(o('fbTimelineNavTopRow'),'li.tile'),jb=0,kb=0,lb=Math.max(0,s-ma),mb=false;for(var nb=0;nb<ib.length;nb++){if(ib[nb]==ia||ib[nb]==ga)continue;mb=((jb+lb)%s===0);i.conditionClass(ib[nb],'leftMost',(jb!==0&&mb));if(!i.hasClass(ib[nb],'empty'))kb=jb;jb++;}mb=((kb+1+lb)%s===0);var ob=ib.length-1-lb;if(mb){if(na&&(kb+1+lb)/s<y){ob=Math.min(ob,kb+s);oa=true;}else ob=kb;}else{var pb=((kb+1+lb)%s);ob=kb+(s-pb);oa=false;}nb=0;for(nb=0;nb<=ob;nb++)if(ib[nb]&&(ib[nb]==ia||ib[nb]==ga)){ob++;}else ib[nb]&&i.hasClass(ib[nb],'empty')&&i.removeClass(ib[nb],'hidden_elem');}function bb(ib,jb,kb){var lb=h.scry(ib,'li.tile');if(!jb)jb=0;var mb=false;for(var nb=jb;nb<lb.length;nb++){mb=((nb-kb)%s===0);var ob=lb[nb];i.conditionClass(ob,'leftMost',mb);if(i.hasClass(ob,'empty'))i.removeClass(ob,'hidden_elem');}}function cb(){ab();var ib=q('fbTimelineNavSecondaryRow');ib&&bb(ib,0,0);}function db(){if(!ga)return;if(i.hasClass(ga,'notready'))return;i.toggleClass(ga,'fbTimelineMoreButtonOpen');var ib=q('fbRecentAppTitle');ib&&i.conditionClass(ib,'hidden_elem',ka===0);if(i.hasClass(ga,'fbTimelineMoreButtonOpen')){cb();}else za();eb();}function eb(){if(ga&&!i.hasClass(ga,'fbTimelineMoreButtonOpen')){ba.style.height='';i.removeClass(ba,'expanded');}else{var ib=ja+(s-ma),jb=((ka>0)?x:0)+t*(Math.ceil(ka/s))+t*(Math.ceil(ib/s))+t*(oa?1:0)+u;i.addClass(ba,'expanded');ba.style.height=jb+'px';}}function fb(ib){var jb=ib==m.TIMELINE_KEY||ib==m.WALL_KEY,kb=k.byClass(ba,'fbTimelineTopSectionBase'),lb=q('timeline_tour_toolbar');if(ga){i.removeClass(ga,'fbTimelineMoreButtonOpen');eb();}lb&&i.conditionShow(lb,jb);if(kb)i.conditionClass(kb,'collapsedHead',!jb);}function gb(event){if(ua)return true;if(!k.byTag(event.getTarget(),'a')){var ib=h.find(ia,'a.title');j.go(ib.href);}}function hb(){if(ga)(function(){ga.removeAttribute('ajaxify');ga.removeAttribute('rel');}).defer();pa&&pa.remove();}return {UPDATE_PAGE:'TimelineNavigation/updatePage',init:function(ib,jb,kb,lb){if(z)return;z=true;ba=ib;ga=jb;ca=n.getRequestURI();ia=h.find(ba,'li.about');fb(l.getCurrentKey());na=lb;g.inform(r.UPDATE_PAGE);if(ga){ha=h.find(ga,'div.text');pa=Event.listen(ga,'click',hb);}qa=o('fbTimelineNavigationLoadContainer');h.appendContent(o('content'),qa);ta=Event.listen(ia,'click',gb);ea.forEach(function(nb){if(!nb[2].remove){va.apply(this,nb);}else wa.apply(this,nb);});ea=[];var mb=k.byClass(ib,'fbTimelineSection');if(mb)h.scry(mb,'ul.uiButtonGroup').forEach(function(nb){p(nb.childNodes).forEach(function(ob){ob.childNodes.length||h.remove(ob);});if(nb.firstChild){i.addClass(nb.firstChild,'firstItem');}else h.remove(nb);});l.register(l.NAV,r);},reset:function(){ta&&ta.remove();ta=null;sa&&sa.remove();sa=null;z=false;ba=null;da=null;fa=[];ga=null;ha=null;ia=null;ja=0;ka=0;la=0;ma=s;na=false;oa=false;qa=null;ra=false;ua=false;},initializeMorePager:function(){if(sa)return;if(ga)sa=Event.listen(ga,'click',db);},registerNav:function(ib,jb,kb){z?(kb.remove?wa.apply(this,arguments):va.apply(this,arguments)):ea.push(arguments);},redraw:function(){cb();eb();},setEditMode:function(ib){ua=ib;}};})();e.exports=a.TimelineNavigation||r;});
__d("legacy:TimelineNavigation",["TimelineNavigation"],function(a,b,c,d){a.TimelineNavigation=b('TimelineNavigation');},3);
__d("legacy:TimelinePerfConfig",["TimelinePerfConfig"],function(a,b,c,d){a.TimelinePerfConfig=b('TimelinePerfConfig');},3);
var TimelineSideAds=(function(){var a=2,b=3,c=75,d='data-height',e=310,f=45,g=30000,h=false,i,j,k,l=[],m,n=false,o,p=Infinity,q=5,r=false,s,t,u,v,w,x,y=false;function z(qa,ra,sa){var ta=0;if(ge('pagelet_timeline_friends'))ta+=e;if(ra)ta+=ra.getHeight();if(!TimelineController.fixedAds()&&!ta)return;qa-=ta;var ua=0;for(var va=0;va<sa;va++)ua+=ja(va);if(ra)if(qa<ua){qa+=ra.fold(ua-qa);}else if(qa>ua)qa-=ra.unfold(qa-ua);return qa;}function aa(){var qa=i.cloneNode(true);qa.id='';var ra=true;DOM.scry(qa,'div.ego_unit').forEach(function(sa){if(ra){ra=false;}else DOM.remove(sa);});CSS.addClass(qa,'fixed_elem');return qa;}function ba(){if(!TimelineController.pageHasScrubber(m)){fa(q);ha();}else if(t){ga(i,false);var qa=u;u&&DOM.remove(u);u=aa();if(qa)oa();fa(TimelineController.sidebarInitialized()&&n?b:a);ha();if(!o){var ra=TimelineController.getCurrentScrubber();if(ra){na(ra.getRoot(),ra.getOffset());}else{var sa=ge('timeline_side_friends');if(sa)na(sa,f);}}o&&o.start();}else TimelineSideAds.adjustAdsToFit();}function ca(){var qa=ge('pagelet_timeline_friends');if(qa)CSS.conditionClass(qa,'fixed_elem',!t);}function da(){if(u){DOM.remove(u);u=null;}if(o){o.stop();o=null;}if(TimelineController.fixedAds()){CSS.conditionClass(i,'fixed_elem',!t);CSS.conditionClass(i,'fbTimelineTopAlignedAds',!TimelineController.pageHasScrubber(m));}else CSS.conditionClass(i,'fixed_elem',!t&&TimelineController.pageHasScrubber(m));ca();}function ea(qa){var ra=Vector2.getViewportDimensions().y,sa=TimelineController.getCurrentScrubber(),ta=sa?sa.getOffset():TimelineController.SCRUBBER_DEFAULT_OFFSET,ua=ra-ta-c;if(sa||TimelineController.fixedAds()||ge('pagelet_timeline_friends'))return z(ua,sa,qa);}function fa(qa){k=Math.min(qa,l.length);for(var ra=0;ra<l.length;ra++)ga(l[ra],ra>=k);ga(i,k===0);}function ga(qa,ra){CSS.conditionClass(qa,'fbTimelineSideAdsOffScreen',ra);qa.setAttribute('aria-hidden',ra?'true':'false');}function ha(){if(!v)return;for(var qa=k-1;qa>=0;--qa){if(o&&o.isFixed()&&((qa!==0)||(u&&!CSS.shown(u))))continue;var ra=DOM.find(l[qa],'div.fbAdUnit'),sa=ra.getAttribute('data-ad'),ta=JSON.parse(sa).adid;if(!v[ta])return;var ua=DOM.create('iframe',{src:URI('/ai.php').addQueryData({aed:v[ta]}),width:0,height:0,frameborder:0,scrolling:'no',className:'fbEmuTracking'});ua.setAttribute('aria-hidden','true');DOM.appendContent(i,ua);delete v[ta];}}function ia(qa){var ra=0;while(qa>0&&ra<q){qa-=ja(ra);if(qa>=0)ra++;}return ra;}function ja(qa){var ra=l[qa];if(!ra)return 0;if(!ra.getAttribute(d))ka(ra);return parseInt(ra.getAttribute(d),10);}function ka(qa){qa.setAttribute(d,qa.offsetHeight);}function la(){for(var qa=0;qa<l.length;qa++){var ra=l[qa];if(!ra)continue;ka(ra);}}function ma(){l=DOM.scry(i,'div.ego_unit');var qa=l.length;if(!qa)return;r=qa;ba();var ra=function(sa){ka(sa);r=--qa;TimelineSideAds.adjustAdsToFit();if(!r)p=Date.now();};l.forEach(function(sa){function ta(){ra.curry(sa).defer();}var ua=DOM.scry(sa,'img.img')[0];if(ua.complete){ta();}else Event.listen(ua,{load:ta,error:ta,abort:ta});});}function na(qa,ra){o=new StickyController(qa,ra,function(sa){if(sa){oa();}else{DOM.remove(u);ha();}});if(u)o.start();}function oa(){DOM.insertAfter(i,u);pa();}function pa(){CSS.conditionShow(u,ja(0)<=ea(1)&&!CSS.hasClass(document.documentElement,'tinyViewport'));}return {init:function(qa,ra,sa){if(h)return;q=sa;h=true;j=ra;i=qa;TimelineSideAds.adjustAdsType(TimelineController.shouldShowWideAds());w=Arbiter.subscribe(['UFI/CommentAddedActive','UFI/CommentDeletedActive','UFI/LikeActive','Curation/Action'],TimelineSideAds.loadAdsFromUserActivity);x=Arbiter.subscribe(['ProfileBrowser/LoadMoreContent'],TimelineSideAds.updateFixedAds);TimelineController.register(TimelineController.ADS,TimelineSideAds);},setRefreshThreshold:function(qa){g=qa;},setShortMode:function(qa,ra){t=ra!=='map'&&qa&&TimelineController.pageHasScrubber(ra);},start:function(qa){v=qa;s=null;ma();},updateCurrentKey:function(qa){if(qa==m)return;m=qa;da();},loadAds:function(qa){if(r||s)return;p=Infinity;s=UIPagelet.loadFromEndpoint('WebEgoPane',i.id,{pid:33,data:[j,false,'timeline_'+qa,t?b:q]},{crossPage:true,bundle:false});},registerScrubber:function(qa){CSS.conditionClass(qa.getRoot(),'fixed_elem',!t);ca();if(t)na(qa.getRoot(),qa.getOffset());!s&&TimelineSideAds.adjustAdsToFit();},loadAdsFromUserActivity:function(){if((Date.now()-p>=g)&&!CSS.hasClass(document.documentElement,'tinyViewport')&&(!o||o.isFixed())&&(!v||!v[l[0]]))TimelineSideAds.loadAds(m+'_refresh');TimelineSideAds.adjustAdsToFit();},updateFixedAds:function(){if(TimelineController.fixedAds())TimelineSideAds.loadAdsFromUserActivity();},adjustAdsType:function(qa){if(qa!=n){CSS.conditionClass(i,'fbTimelineVerticalAds',!qa);u&&CSS.conditionClass(u,'fbTimelineVerticalAds',!qa);n=qa;la();TimelineSideAds.adjustAdsToFit();var ra=ge('timeline_side_friends');if(ra)CSS.conditionClass(ra,'fbTimelineVerticalSideFriends',!qa);var sa=ge('rightColContent');if(sa)CSS.conditionClass(sa,'fbTimelineWideRightCol',qa);}},adjustAdsToFit:function(){if(!i||y)return;y=true;var qa=n?b:a;if(t){if(o&&u){o.handleScroll();if(o.isFixed()){CSS.conditionShow(u,ja(0)<=ea(1)&&!CSS.hasClass(document.documentElement,'tinyViewport'));}else fa(qa);ha();}}else{var ra=ea(qa);if(typeof ra!=='undefined'){fa(ia(ra));if(!r)ha();}}y=false;},reset:function(){o&&o.stop();s&&s.cancel();l=[];n=false;i=null;o=null;s=null;r=null;t=null;u=null;m=null;p=Infinity;h=false;w&&Arbiter.unsubscribe(w);w=null;x&&Arbiter.unsubscribe(x);x=null;}};})();
__d("TimelineStickyHeader",["Arbiter","CSS","DOM","TimelineController","ViewportBounds"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('TimelineController'),k=b('ViewportBounds'),l=false,m=false,n,o,p,q,r={VISIBLE:'TimelineStickyHeader/visible',ADJUST_WIDTH:'TimelineStickyHeader/adjustWidth',init:function(s){if(l)return;l=true;n=s;o=i.find(s,'div.name');p=i.find(s,'div.actions');q=k.addTop(function(){return m?s.offsetTop+s.scrollHeight:0;});j.register(j.STICKY_HEADER,r);},reset:function(){l=false;m=false;n=null;o=null;p=null;q.remove();q=null;},toggle:function(s){h.conditionClass(n,'fbTimelineStickyHeaderHidden',!s);if(s!==m){m=s;g.inform(r.VISIBLE,s);}},adjustWidth:function(){g.inform(r.ADJUST_WIDTH,o,g.BEHAVIOR_STATE);},getRoot:function(){return n;},setActions:function(s){if(l&&s){i.setContent(p,s);p=s;}}};e.exports=a.TimelineStickyHeader||r;});
__d("legacy:TimelineStickyHeader",["TimelineStickyHeader"],function(a,b,c,d){a.TimelineStickyHeader=b('TimelineStickyHeader');},3);
__d("TimelineStickyHeaderNav",["array-extensions","event-extensions","function-extensions","Arbiter","ButtonGroup","CSS","DOM","Parent","Selector","Style","TimelineController","URI","UserAgent","Vector","ge","tx"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ButtonGroup'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Selector'),m=b('Style'),n=b('TimelineController'),o=b('URI'),p=b('UserAgent'),q=b('Vector'),r=b('ge'),s=b('tx'),t=false,u,v,w,x,y,z,aa,ba,ca,da,ea,fa={},ga={},ha=[],ia=false,ja=[],ka=[],la=[],ma=[],na=["January","February","March","April","May","June","July","August","September","October","November","December"];function oa(event){var db=k.byTag(event.getTarget(),'a');if(db){n.navigateToSection(db.getAttribute('data-key'));event.prevent();}}function pa(db,eb){var fb=l.getValue(eb);if(fb==='allStories')n.getSection(db).expandSubSections();if(fb!=='activityLog')qa(eb);}function qa(db){ab(db,'highlights');ab(db,'allStories');var eb=j.find(db,'li.separator');i.conditionShow(eb,eb.previousSibling);}function ra(db){if(ca[db]&&!v.custom_subsection_menu){xa(db);}else ua();n.adjustStickyHeaderWidth();}function sa(db,eb){var fb=eb.key;if(da[fb]){ya(fb);ra(fb);}}function ta(db,eb){var fb=eb.scrubberKey;ya(fb);if(w===fb)ra(fb);}function ua(){x.hideItem(aa);}function va(db){var eb=db.split('_');return na[eb.pop()-1];}function wa(db){var eb=ba[db],fb=ca[db];if(!eb&&fb){eb=ba[db]=aa.cloneNode(true);var gb=j.scry(eb,'li.activityLog a')[0];if(gb)gb.href=o(gb.href).addQueryData({key:db});var hb=n.getCurrentScrubber();if(fb.length)i.show(j.find(eb,'li.separator'));for(var ib=0;ib<fb.length;ib++){var jb=fb[ib].scrubberKey,kb=hb?hb.getLabelForSubnav(fb[ib].parentKey,jb):kb=va(jb);if(kb)za(eb,{key:jb,label:kb});}if(bb()){qa(eb);l.setSelected(eb,j.scry(eb,'option')[1].value,true);}ma.push(l.listen(eb,'change',pa.curry(db,eb)));ka.push(Event.listen(eb,'click',oa));}return eb;}function xa(db){var eb=wa(db);j.insertAfter(aa,eb);i.hide(aa);for(var fb in ba){var gb=ba[fb];i.conditionShow(gb,gb===eb);}x.showItem(aa);}function ya(db){ca[db]=n.getSection(db).subSections;}function za(db,eb){var fb=j.create('a',{href:'#',rel:'ignore',className:'itemAnchor',tabIndex:0},j.create('span',{className:'itemLabel fsm'},eb.label));fb.setAttribute('data-key',eb.key);fb.setAttribute('aria-checked',false);var gb=j.create('li',{className:'uiMenuItem uiMenuItemRadio uiSelectorOption'},fb);gb.setAttribute('data-label',eb.label);var hb=j.find(db,'ul.uiMenuInner'),ib=j.create('option',{value:eb.key},eb.label),jb=j.find(db,'select');if(eb.key==='recent'){j.prependContent(hb,gb);j.insertAfter(jb.options[0],ib);}else{j.appendContent(hb,gb);j.appendContent(jb,ib);}}function ab(db,eb){var fb=j.scry(db,'li.uiMenuItem');if(!fb)return;for(var gb=0;gb<fb.length;gb++){var hb=fb[gb];if(i.hasClass(hb,eb)||hb.firstChild.getAttribute('data-key')==eb){j.remove(hb);break;}}var ib=j.find(db,'select'),jb=j.scry(ib,'option');for(gb=0;gb<jb.length;gb++)if(jb[gb].value===eb){j.remove(jb[gb]);return;}}function bb(){return n.getCurrentKey()==='allactivity'||n.getCurrentKey()==='approve';}var cb={init:function(db,eb){if(t)return;t=true;u=db;v=eb||{};y=j.find(u,'div.pageMenu');z=j.find(u,'div.sectionMenu');aa=j.find(u,'div.subsectionMenu');ea=j.find(y,'li.uiMenuSeparator');x=h.getInstance(y);ba={};ca={};da={};cb.adjustMenuHeights();n.register(n.STICKY_HEADER_NAV,cb);if(r('pagelet_timeline_friends'))cb.addTimePeriods(n.getSectionKeys());},reset:function(){t=false;v={};ha=[];fa={};ga={};ia=false;ja=[];u=null;y=null;z=null;aa=null;ea=null;ba={};ca={};da={};while(ka.length)ka.pop().remove();la.forEach(g.unsubscribe);ma.forEach(l.unsubscribe.bind(l));},addTimePeriods:function(db){if(!db.length)return;if(v.pull_from_scrubber){j.setContent(j.find(z,'ul.uiMenuInner'),'');j.remove(j.find(z,'select').children[1]);while(db.length){var eb=db.shift();eb&&cb.addTimePeriod(eb);}x.showItem(z);}var fb=l.getSelectorMenu(z);ka.push(Event.listen(fb,'click',oa));var gb=bb()?n.SECTION_REGISTERED:n.SECTION_LOADED,hb=bb()?ta:sa;la.push(g.subscribe(gb,hb));},addTimePeriod:function(db){var eb=n.getCurrentScrubber();if(!eb)return;var fb=eb.getLabelForNav(db);if(!fb)return;za(z,{key:db,label:fb});var gb=j.find(z,'ul.uiMenuInner');if(db==='recent'||gb.children.length<2)l.setSelected(z,db,true);},updateSection:function(db,eb){if(eb){var fb=wa(db);if(fb){l.setSelected(fb,eb);qa(fb);}else w=db;}else{da[db]=true;ya(db);}l.setSelected(z,db,true);ra(db);},adjustMenuHeights:function(){if(p.ie()<=7)return;[y,z].forEach(function(db){var eb='';if(!i.hasClass(document.documentElement,'tinyViewport')){eb=q.getViewportDimensions().y-q.getElementDimensions(r('blueBar')).y-80;eb+='px';}m.set(j.find(db,'ul.uiMenuInner'),'maxHeight',eb);});},initPageMenu:function(db,eb){function fb(gb,hb){gb.forEach(function(ib){var jb=ga[ib]=j.create('li');i.hide(jb);hb?j.insertBefore(ea,jb):j.appendContent(j.find(y,'ul.uiMenuInner'),jb);});}fb(db,true);fb(eb,false);fa.info=j.scry(y,'li')[0];ha=eb;ia=true;if(ja.length)ja.forEach(function(gb){cb.registerPageMenuItem(gb.key,gb.item);});},registerPageMenuItem:function(db,eb){if(!ia){ja.push({key:db,item:eb});return;}if(ga[db]){j.replace(ga[db],eb);fa[db]=eb.getNodes()[0];delete ga[db];if(ha.indexOf(db)>=0)i.show(ea);}},removeTimePeriod:function(db){ab(z,db);}};e.exports=cb;});
__d("legacy:TimelineStickyHeaderNav",["TimelineStickyHeaderNav"],function(a,b,c,d){a.TimelineStickyHeaderNav=b('TimelineStickyHeaderNav');},3);
__d("legacy:TimelineThrottler",["TimelineThrottler"],function(a,b,c,d){a.TimelineThrottler=b('TimelineThrottler');},3);
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("HubsTypeaheadView",["Class","ContextualTypeaheadView","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ContextualTypeaheadView'),i=b('copyProperties');function j(k,l){this.parent.construct(this,k,l);}g.extend(j,h);i(j.prototype,{render:function(k,l,m){if(this.alwaysRender&&k!==''){var n=k.toLowerCase().trim(),o=false;for(var p=0;p<l.length;p++)if(n==l[p].text.toLowerCase()){o=true;break;}if(!o)l.push({text:k,type:'calltoaction'});}return this.parent.render(k,l,m);}});e.exports=j;});
__d("TypeaheadSetPhotoOnSelect",["event-extensions","function-extensions","CSS","DOM","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('CSS'),h=b('DOM'),i=b('copyProperties');function j(k){this._typeahead=k;}i(j.prototype,{_eventListener:null,_subscription:null,enable:function(){var k=h.scry(this._typeahead.getElement(),'.photo')[0];if(k){if(!h.isNodeOfType(k,'img')){var l=h.create('img',{className:k.className});h.replace(k,l);k=l;}var m=g.hide.curry(k),n=g.show.curry(k);this._eventListener=Event.listen(k,{load:n,error:m,abort:m});this._subscription=this._typeahead.subscribe('select',function(o,p){var q=p.selected.photo||this._typeahead.view.fallbackPhoto;q?k.setAttribute('src',q):m();}.bind(this));}},disable:function(){this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=j;});
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d){var e=b('TypeaheadSetPhotoOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(f){f.enableBehavior(e);};},3);
function TimelineAggregateMapUnitStatic(){}copy_properties(TimelineAggregateMapUnitStatic.prototype,{THROBBER_OFFSET_X:10,THROBBER_OFFSET_Y:5,init:function(a,b,c,d,e,f,g,h){var i=$(b);handler=function(){var j={map_id:a,start:c,end:d,profile_id:e,hash:f,unit_type:g};if(h)j.viewas=h;new AsyncRequest().setURI('/ajax/timeline/map_unit/dynamic').setData(j).send();CSS.addClass(i,'aero');var k=DOM.find(i,'.fbTimelineAggregatedMapUnitSeeAllText'),l=Vector2.getElementPosition(k),m=Vector2.getElementDimensions(k),n=Vector2.getElementPosition($(a)),o=l.add(m.mul(.5)).sub(new Vector2(this.THROBBER_OFFSET_X,this.THROBBER_OFFSET_Y)).sub(n),p=DOM.find($(a),'.fbTimelineAggregatedMapUnitThrobber');CSS.setStyle(p,'left',o.x+'px');CSS.setStyle(p,'top',o.y+'px');CSS.show(p);}.bind(this);Event.listen(i,'click',handler);}});
function TimelineCoverDisclaimer(a,b,c){if(TimelineCoverDisclaimer.displayed===undefined){TimelineCoverDisclaimer.displayed=true;}else return;new Dialog().setModal(true).setTitle(a).setBody(b).setButtonsMessage(c).setButtons(Dialog.OK).show();}
__d("TimelineStar",["event-extensions","Button","CSS","DOM","Parent","TimelineCapsule","Tooltip","URI"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('Parent'),k=b('TimelineCapsule'),l=b('Tooltip'),m=b('URI'),n={STAR_CSS_ONLY:1,STAR_ASYNC_REQUIRED:2,ACTION_STAR:7,ACTION_UNSTAR:8,starUnitFromButton:function(o,p,q){var r=j.byClass(o,'timelineUnitContainer');n.starUnit(r,p,q);},starUnit:function(o,p,q){var r=o.parentNode;if(!q)i.setContent(r,p);h.removeClass(r,'fbTimelineTwoColumn');h.addClass(r,'fbTimelineOneColumn');r.removeAttribute('data-side');r.setAttribute('data-size','2');l.hide();k.balanceCapsule.curry(r.parentNode).defer();},unstarUnitFromButton:function(o,p,q){var r=j.byClass(o,'timelineUnitContainer');n.unstarUnit(r,p,q);},unstarUnit:function(o,p,q){var r=o.parentNode;if(!q)i.setContent(r,p);h.removeClass(r,'fbTimelineOneColumn');h.addClass(r,'fbTimelineTwoColumn');r.setAttribute('data-side','l');r.setAttribute('data-size','1');l.hide();k.balanceCapsule.curry(r.parentNode).defer();},listenToButton:function(o,p){if(!o)return;switch(p){case n.STAR_CSS_ONLY:Event.listen(o,'click',function(event){g.setEnabled(o,false);var r=j.byClass(o,'timelineUnitContainer'),s=n.unstarUnit;h.toggleClass(o,'fbTimelineStarButtonSelected');h.toggleClass(o,'selected');if(r.parentNode.getAttribute('data-size')=='1')s=n.starUnit;s(r,null,true);var t=new m(o.getAttribute('ajaxify')),u=t.getQueryData().customize_action==n.ACTION_STAR?n.ACTION_UNSTAR:n.ACTION_STAR;t.addQueryData({customize_action:u});o.setAttribute.bind(o,'ajaxify',t).defer();});var q=j.byClass(o,'stat_elem');q&&h.removeClass(q,'stat_elem');break;case n.STAR_ASYNC_REQUIRED:break;}}};e.exports=n;});
__d("OnlyMeUI",["Arbiter","CSS","DOM","Parent","PrivacyConst","Selector","$","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('Parent'),k=b('PrivacyConst'),l=b('Selector'),m=b('$'),n=b('tx');function o(){return [i.create('div',{className:'onlyMeBorder'}),i.create('div',{className:'onlyMeBorder onlyMeBorderBottom'})];}function p(){return i.create('img',{alt:' ',className:'onlyMePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function q(v){var w=i.scry(v,'.photoUnit a.photo');return w.filter(function(x){return !i.scry(x,'.onlyMePrivacyCorner').length;});}function r(v,w){h.addClass(v,'storyOnlyMe');if(!h.hasClass(v,'timelineRecentActivityStory'))i.setContent(i.find(w,'span.uiButtonText'),"Only Me");if(!h.hasClass(v,'storyContent')){var x=q(v);for(var y=0,z=x.length;y<z;++y)i.appendContent(x[y],p());}if(!i.scry(v,'div.onlyMeBorder').length){var aa=o();i.prependContent(v,aa[0]);i.appendContent(v,aa[1]);}}function s(v){if(!v)return;var w=j.byClass(v,'storyContent')||j.byClass(v,'timelineRecentActivityStory')||j.byClass(v,'timelineUnitContainer')||j.byClass(v,'fbTimelineTwoColumn');if(!w){w=i.scry(v,'^.permalink_stream .storyContent');w=w.length&&w[0];}else if(h.hasClass(w,'fbTimelineComposerUnit'))return null;return w;}var t=false,u={init:function(){if(t)return;t=true;g.subscribe('AudienceSelector/changed',function(v,w){var x=s(w.selector)||s(w.clone);if(!x)return;if(l.getOptionValue(w.option)==k.BaseValue.SELF){r(x,w.selector);}else h.removeClass(x,'storyOnlyMe');});},setOnlyMe:function(v){if(t)return;u.init();v=i.find(j.byClass(m(v),'uiSelector'),'a.uiSelectorButton');var w=s(v);w&&r(w,v);}};e.exports=u;});
__d("CountButtonCount",["ArbiterMixin","copyProperties","DOM"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('copyProperties'),i=b('DOM');function j(k,l,m){this._root=k;this._count=l;this._max=m;}h(j.prototype,g,{getCount:function(){return this._count;},setCount:function(k){this._count=k;var l=this.getDisplayedValue();i.setContent(this._root,l);this.inform('change',{value:this._count,display:l});return this;},addCount:function(k){this.setCount(this.getCount()+k);return this;},getDisplayedValue:function(){return Math.max(0,Math.min(this._count,this._max));}});e.exports=j;});
__d("CountButton",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx'),j={large:"-cx-PRIVATE-uiCountButton__counterLarge",small:"-cx-PRIVATE-uiCountButton__counterSmall",hidden:"-cx-PRIVATE-uiCountButton__counterHidden"};function k(l,m){this._root=l;this._counter=m;this._initEvents();}g(k.prototype,{_initEvents:function(){this._counter.subscribe('change',this._counterChange.bind(this));},_counterChange:function(l,m){h.removeClass(this._root,j.large);h.removeClass(this._root,j.small);h.removeClass(this._root,j.hidden);if(m.value>9){h.addClass(this._root,j.large);}else if(m.value>0){h.addClass(this._root,j.small);}else h.addClass(this._root,j.hidden);},getCounter:function(){return this._counter;}});e.exports=k;});
__d("legacy:LayerHideOnBlur",["LayerHideOnBlur"],function(a,b,c,d){a.LayerHideOnBlur=b('LayerHideOnBlur');},3);
__d("TimelinePerfConfig",[],function(a,b,c,d,e,f){var g=null,h=function(){if(g===null)return false;return true;},i={init:function(j){g=j;},getDisablePageletThrottle:function(){return h()&&(g.disablePageletThrottle||g.disableAllThrottle);},getDisableAllThrottle:function(){return h()&&g.disableAllThrottle;},getDisableSpineHeight:function(){return h()&&g.disableSpineHeight;}};e.exports=i;});
__d("TimelineThrottler",["event-extensions","Arbiter","TimelinePerfConfig","copyProperties","debounce","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('TimelinePerfConfig'),i=b('copyProperties'),j=b('debounce'),k=b('throttle');function l(m){this.id=m;this.idle=true;this.keys={};this.queue=[];this.config={};this.configure();l.instances[m]=this;}l.getInstance=function(m){return l.instances[m]||new l(m);};l.instances={};l.config={};l.REQUEUE='requeue';g.subscribe("Timeline/throttle",function(m,n){l.config=n;for(var o in l.instances)l.instances[o].configure();});i(l.prototype,{configure:function(){if(this._handle)this._handle.remove();var m=j(function(){this.idle=true;this._process();},l.config.scrollDelay||400,this),n=k(function(){this.idle=false;m();},l.config.scrollThrottle||100,this);this._handle=Event.listen(window,'scroll',n);i(this.config,l.config[this.id]);},cancel:function(){this.idle=true;this.keys={};this.queue=[];this.config={};this._handle&&this._handle.remove();},_limit:function(m,n,o){if(h.getDisableAllThrottle()){m();return;}var p=m;if(n){if(this.keys[n])if(o){this.queue.splice(this.queue.indexOf(this.keys[n]),1);}else return;this.keys[n]=m;p=function(){delete this.keys[n];m();}.bind(this);}this.queue.push(p);this._process();},throttle:function(m,n){this._limit(m,n,false);},debounce:function(m,n){this._limit(m,n,true);},_process:function(){if(this.idle&&this.queue.length){var m=this.queue.shift(),n=m();if(n===l.REQUEUE)this.queue.push(m);setTimeout(this._process.bind(this),this.config.delay||0);}}});e.exports=l;});
__d("TimelineContentLoader",["Arbiter","CSS","DOM","DOMScroll","OnVisible","ScrollingPager","TimelineConstants","TimelineController","TimelinePerfConfig","TimelineSmartInsert","TimelineThrottler","TimelineURI","UIPagelet","UserAgent","Vector","$","copyProperties","createArrayFrom","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DOMScroll'),k=b('OnVisible'),l=b('ScrollingPager'),m=b('TimelineConstants'),n=b('TimelineController'),o=b('TimelinePerfConfig'),p=b('TimelineSmartInsert'),q=b('TimelineThrottler'),r=b('TimelineURI'),s=b('UIPagelet'),t=b('UserAgent'),u=b('Vector'),v=b('$'),w=b('copyProperties'),x=b('createArrayFrom'),y=b('debounce'),z=b('ge'),aa=b('startsWith'),ba=b('tx'),ca=b('userAction'),da=false,ea=false,fa,ga={},ha=null,ia={},ja=[],ka=[],la={},ma={},na={},oa=null,pa=null,qa=null,ra=false,sa=null;function ta(eb,fb,gb,hb,ib){this.node=eb;this.loaded=hb;this.canScrollLoad=true;this.canUnload=fb!=db.RECENT;this.scrubberKey=fb;this.historicUnitCount=ib;this._pageletLoadData=gb;this._expandPageletLoadData={};}w(ta.prototype,{load:function(eb){if(this.loaded)return;var fb=this._pageletLoadData;g.inform(n.SECTION_LOADING,{data:fb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var gb='ProfileTimelineSectionPagelet';if(this.scrubberKey==db.WAY_BACK)gb='ProfileTimelineRemainingYearsPagelet';fb.time_cutoff=db.getTimeCutoff();fb.highlight_unit_data=eb;fb.parent_key=this.parentKey;fb.force_no_friend_activity=ra;h.addClass(this.node,'fbTimelineSectionLoading');var hb=null;if(!eb&&!o.getDisablePageletThrottle())hb=xa.curry(this.node);if(this.canUnload&&ea){var ib=this.node.firstChild.cloneNode(true);h.hide(ib);i.insertAfter(this.node,ib);}else this.canScrollLoad=false;na[this.scrubberKey]=s.loadFromEndpoint(gb,this.node.id,fb,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:hb});cb(this.scrubberKey);},preload:function(){h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var eb=i.find(this.node,'span.sectionLabel');if(eb.getAttribute('data-original-label')){i.setContent(eb,eb.getAttribute('data-original-label'));eb.removeAttribute('data-original-label');}},unload:function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;na[this.scrubberKey]&&na[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();},activateScrollLoad:function(){this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');ma[this.scrubberKey]&&ma[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');ma[this.scrubberKey]&&ma[this.scrubberKey].remove();}},setExpandLoadData:function(eb){this._expandPageletLoadData=eb;return this;},expandSubSections:function(){if(this.subSections.length)db.navigateToSection(this.subSections[0].scrubberKey);},expand:function(eb){if(!this.loaded)return;qa.add_event('expand_'+this.scrubberKey);var fb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(fb.firstChild,'async_saving');eb&&h.addClass(eb,'async_saving');this._expandPageletLoadData.time_cutoff=db.getTimeCutoff();db.navigateToSection(this.scrubberKey);i.scry(this.node,'ol.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;na[this.scrubberKey]&&na[this.scrubberKey].cancel();na[this.scrubberKey]=s.loadFromEndpoint('ProfileTimelineSectionPagelet',fb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});},isPermalinkPeriod:function(){return this._pageletLoadData.is_permalink_period;}});function ua(){if(da)return;n.register(n.CONTENT,db);qa=ca('scrubber').set_namespace('timeline').set_ua_id('scrubber');da=true;if(t.ie()<=7)ea=true;}var va=y(function(eb,fb,gb){var hb=db.getSection(eb).historicUnitCount;fb-=hb;gb-=1;if(hb==-1||gb<=0||fb<0)return;var ib=db.getNextSectionKey(eb);if(ib){db.getSection(ib).load();va(ib,fb,gb);}},500),wa={};function xa(eb,fb){oa=q.getInstance('displayPagelet');oa.throttle(function(){var gb=u.getViewportDimensions().y,hb=u.getScrollPosition().y,ib=hb+gb,jb=hb+gb*(oa.config.fociRatio||.5),kb=u.getElementPosition(eb).y;if(kb>jb)if(kb<ib){wa[eb.id]=(wa[eb.id]||0)+1;if(wa[eb.id]<(oa.config.fociPenalty||3))return q.REQUEUE;}else{delete wa[eb.id];return q.REQUEUE;}delete wa[eb.id];fb();});}function ya(eb,fb,gb){var hb=db.getNextSectionKey(fb);if(hb)ma[hb]=new k(eb,za.curry(hb,eb),false,gb||1000);}function za(eb,fb){if(ga[eb].canScrollLoad){qa.add_event("scroll_load_"+eb);if(ea){db.getSection(eb).preload();}else{db.getSection(eb).load();if(sa)va(eb,sa.required_units,sa.max_parallelism);}fb&&i.remove(fb);}}function ab(){var eb,fb,gb=false;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;var jb=db.getSection(ib);if(jb.canScrollLoad||jb.loaded){if(!jb.loaded){h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}if(eb&&fb){bb(eb,fb);if(gb)eb.deactivateScrollLoad();gb=true;}eb=null;fb=null;continue;}else if(eb){fb=jb;jb.deactivateScrollLoad();}else{eb=jb;if(gb)jb.activateScrollLoad();}h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}}function bb(eb,fb){h.removeClass(fb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(fb.node,'fbTimelineTimePeriodSuppressed');var gb=i.find(eb.node,'span.sectionLabel'),hb=i.find(fb.node,'span.sectionLabel');if(!hb.getAttribute('data-original-label'))hb.setAttribute('data-original-label',i.getText(hb));if(gb.getAttribute('data-month')&&hb.getAttribute('data-month')&&gb.getAttribute('data-year')==hb.getAttribute('data-year')){i.setContent(hb,ba._("Show {month1} - {month2} {year}",{month1:hb.getAttribute('data-month'),month2:gb.getAttribute('data-month'),year:gb.getAttribute('data-year')}));}else if(gb.getAttribute('data-year')!==hb.getAttribute('data-year')){i.setContent(hb,ba._("Show {year1} - {year2}",{year1:hb.getAttribute('data-year'),year2:gb.getAttribute('data-year')}));}else i.setContent(hb,ba._("Show {year}",{year:hb.getAttribute('data-year')}));}function cb(eb){if(ea)for(var fb=0;fb<ja.length-1;fb++){var gb=ja[fb];if(!gb)continue;if(gb!=eb){var hb=ga[gb];if(hb.loaded&&hb.canUnload)hb.unload();}}ab();}var db={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(eb,fb,gb,hb,ib,jb,kb){ua();if(ka.contains(fb))return;var lb=new ta(eb,fb,gb,hb,kb);if(!ib){ja[jb]=fb;ia[fb]=true;}else{lb.parentKey=ib;ga[ib].subSections=ga[ib].subSections||[];ga[ib].subSections[jb]=lb;}ga[fb]=lb;db.checkCurrentSectionChange();g.inform(n.SECTION_REGISTERED,{scrubberKey:fb});n.registerSectionKey(fb,jb);},reset:function(){for(var eb in ma)ma[eb].remove();for(var fb in na)na[fb].cancel();fa&&fa.unsubscribe();fa=null;oa&&oa.cancel();oa=null;ga={};ha=null;ia={};ja=[];ka=[];la={};ma={};na={};pa=null;qa=null;ra=false;da=false;},checkCurrentSectionChange:function(){var eb=db.getCurrentSection(),fb=ha&&ha.scrubberKey;if(eb&&eb.scrubberKey!==fb&&!eb.isPermalinkPeriod()){ha=eb;var gb=eb.scrubberKey,hb=eb.parentKey;if(!hb){hb=gb;gb=null;}n.sectionHasChanged(hb,gb);}},setTimeCutoff:function(eb){pa=eb;},getTimeCutoff:function(){return pa;},setParallelLoadConfig:function(eb){sa=eb;},getCurrentSection:function(){var eb={};for(var fb in ga){var gb=ga[fb];if(!gb.loaded||la[gb.scrubberKey])continue;var hb=u.getElementPosition(gb.node,'viewport').y;if(gb.scrubberKey=='recent')hb--;if(hb<db.CURRENT_SECTION_OFFSET)eb[hb]=gb;}var ib=Math.max.apply(null,Object.keys(eb)),jb=ib==-Infinity;if(!jb){return eb[ib];}else if(ja[0])return ga[ja[0]];return null;},capsuleForCurrentSection:function(){var eb=db.getCurrentSection();return eb&&i.scry(eb.node,'ol.fbTimelineCapsule')[0];},enableScrollLoad:function(eb,fb,gb){var hb=i.scry(eb.parentNode,'ol.fbTimelineCapsule')[0];if(!hb)return;ya(eb,fb,gb);},getSection:function(eb){return ga[eb];},getNextSectionKey:function(eb){for(var fb=0;fb<ja.length-1;fb++)if(ja[fb]==eb){while(fb<ja.length-1&&!ja[fb+1])fb++;return ja[fb+1];}var gb=db.getSection(eb);if(!gb||!gb.parentKey)return;var hb=db.getSection(gb.parentKey);if(!hb)return;for(var ib=0;ib<hb.subSections.length-1;ib++)if(hb.subSections[ib].scrubberKey==eb)return hb.subSections[ib+1].scrubberKey;},hideSection:function(eb){var fb=db.getSection(eb);fb&&h.hide(fb.node);var gb=n.getCurrentScrubber();if(gb){var hb=n.getCurrentScrubber().getNav(eb);hb&&h.hide(hb);}var ib=n.getCurrentStickyHeaderNav();ib&&ib.removeTimePeriod(eb);la[eb]=true;},removeSection:function(eb){for(var fb in ja)if(ja[fb]==eb){ja[fb]=null;break;}delete ga[eb];delete ia[eb];if(eb in ma){ma[eb].remove();delete ma[eb];}var gb=n.getCurrentStickyHeaderNav();gb&&gb.removeTimePeriod(eb);ka.push(eb);},navigateToSection:function(eb,fb,gb){qa.add_event("nav_"+eb);fb=!!fb;var hb=eb,ib=db.getSection(eb);if(!ib)return;if(!ib.loaded)p.enable();if(!ia[eb]){ib.node.style.minHeight=u.getViewportDimensions().y+'px';var jb=g.subscribe(n.SECTION_FULLY_LOADED,function(rb,sb){if(sb.scrubberKey===eb){ib.node.style.minHeight='';jb.unsubscribe();}});hb=ib.parentKey;var kb=db.getSection(hb).node;if(!h.hasClass(kb,'fbTimelineSectionExpanded')){j.scrollTo(kb,0);h.addClass(kb,'fbTimelineSectionExpanded');i.scry(kb,'ol.fbTimelineCapsule').forEach(i.remove);i.scry(kb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(kb,'div.fbTimelineContentHeader').forEach(i.remove);}var lb=db.getNextSectionKey(hb);if(lb&&ma[lb])ma[lb].setBuffer(0);}for(var mb=0;mb<ja.length;mb++){var nb=ja[mb];if(!nb)continue;if(nb==hb)break;db.getSection(nb).deactivateScrollLoad();i.scry(v('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(rb){var sb=l.getInstance(rb.id);sb&&sb.removeOnVisible();});}db.adjustContentPadding();ib.load(gb);ab();var ob=u.getScrollPosition().x,pb=u.getElementPosition(ib.node).y;if(!fb){var qb=ia[eb]?m.SCROLL_TO_OFFSET:m.SUBSECTION_SCROLL_TO_OFFSET;j.scrollTo(new u(ob,pb-qb,'document'),true,false,false,function(){var rb=u.getElementPosition(ib.node).y;j.scrollTo(new u(ob,rb-qb,'document'),false);var sb=i.scry(ib.node,'h3.uiHeaderTitle')[0];sb&&sb.focus();});}},adjustContentPadding:function(){var eb=z('timeline_tab_content');if(!eb)return;var fb=n.getCurrentKey()||r.TIMELINE_KEY;if(fb!==r.TIMELINE_KEY)return;var gb=db.getSection(db.WAY_BACK);eb.style.paddingBottom=gb&&gb.loaded?null:u.getViewportDimensions().y-db.CURRENT_SECTION_OFFSET-db.HEADER_SCROLL_CUTOFF-db.FOOTER_HEIGHT+'px';},suppressSectionsAbove:function(eb){var fb,gb;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;fb=db.getSection(ib).node;gb=null;if(x(eb.parentNode.children).indexOf(eb)<=x(fb.parentNode.children).indexOf(fb)){gb=ib;break;}db.getSection(ib).deactivateScrollLoad();}if(gb)db.navigateToSection(gb,true);},forceNoFriendActivity:function(){ra=true;},removeDupes:function(eb){var fb=z(eb);if(!fb)return;var gb=i.scry(fb,'li.fbTimelineUnit'),hb={};for(var ib=0;ib<gb.length;ib++){var jb=gb[ib];if(jb.id&&aa(jb.id,'tl_unit_')){var kb=jb.id.substring(8,jb.id.length),lb=(jb.getAttribute('data-unit')=='ExperienceSummaryUnit'?jb.getAttribute('data-time'):1);if(hb.hasOwnProperty(kb)&&hb[kb]==lb){i.remove(jb);}else hb[kb]=lb;}}}};e.exports=a.TimelineContentLoader||db;});
__d("TimelineCapsule",["$","Arbiter","createArrayFrom","CSS","DataStore","DOM","DOMQuery","DOMScroll","ge","Hovercard","Parent","TimelineConstants","TimelineContentLoader","TimelineController","TimelineSmartInsert","TimelineThrottler","UserAgent","Vector","isEmpty"],function(a,b,c,d,e,f){var g=b('$'),h=b('Arbiter'),i=b('createArrayFrom'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('DOMQuery'),n=b('DOMScroll'),o=b('ge'),p=b('Hovercard'),q=b('Parent'),r=b('TimelineConstants'),s=b('TimelineContentLoader'),t=b('TimelineController'),u=b('TimelineSmartInsert'),v=b('TimelineThrottler'),w=b('UserAgent'),x=b('Vector'),y=b('isEmpty'),z=(function(){var aa=45,ba=15,ca={},da={},ea={},fa={};function ga(ya){return j.hasClass(ya,'fbTimelineBalancer');}function ha(ya){return ya.getAttribute('data-spine');}function ia(ya){return j.hasClass(ya,'placeholderUnit');}function ja(ya){return ya.getAttribute('data-fixed');}function ka(ya,za){if(za)return (k.get(r.DS_SIDEORG,ya.id)||ya.getAttribute('data-side'));return ya.getAttribute('data-side');}var la=function(ya,za){if(w.ie()<=6){la=function(ab,bb){k.set(r.DS_SIDEORG,ab.id,ka(ab,true));ab.setAttribute('data-side',bb);j.removeClass(ab,'leftColumn');j.removeClass(ab,'rightColumn');j.addClass(ab,bb=='l'?'leftColumn':'rightColumn');};}else la=function(ab,bb){k.set(r.DS_SIDEORG,ab.id,ka(ab,true));ab.setAttribute('data-side',bb);};la(ya,za);};function ma(ya){return ya.getAttribute('data-size');}var na=function(ya,za){if(ga(ya))return;if(za){j.addClass(ya,'balancingCapsule');}else j.removeClass(ya,'balancingCapsule');};function oa(ya){if(j.hasClass(ya,'fbTimelineIndeterminateContent'))return 0;return ba;}function pa(ya,za){var ab=0;if(j.shown(ya)&&!j.hasClass(ya,'placeholderUnit'))if(za){ab=ya.getAttribute('data-calculatedheight');}else ab=ya.offsetHeight+oa(ya);if(za&&ab===null)ab=300;k.set(r.DS_HEIGHT,ya.id,parseInt(ab,10));}function qa(ya){var za=k.get(r.DS_HEIGHT,ya.id,null);return za;}function ra(ya,za){if(ma(za)=='2'){return 0;}else if(ka(za)=='r'){return ya+qa(za);}else return ya-qa(za);}function sa(ya){var za=ya.parentNode;if(!za)return;var ab=document.createDocumentFragment(),bb=ya.firstChild;while(bb.firstChild)ab.appendChild(bb.firstChild);u.run(za,l.replace.curry(ya,ab));}function ta(ya){for(var za=0;za<ya.children.length;za++){var ab=ya.children[za];if(!ab.getAttribute('data-endmarker'))continue;var bb=ab.getAttribute('data-endmarker'),cb=ab.getAttribute('data-pageindex'),db=function(){k.set(r.DS_LOADED,ya.id,cb);l.remove(ab);h.inform(t.SECTION_FULLY_LOADED,{scrubberKey:bb,pageIndex:cb,capsuleID:ya.id,childCount:ya.children.length});};if(s.getSection(bb)){db();}else var eb=h.subscribe(t.SECTION_REGISTERED,function(fb,gb){if(gb.scrubberKey===bb){db();eb.unsubscribe();}});break;}na(ya,false);h.inform('TimelineCapsule/balanced',{capsule:ya});}function ua(ya,za,ab){while(za[0])la(za.pop(),'l');while(ab[0])la(ab.pop(),'r');if(ga(ya))sa(ya);ta(ya);}function va(ya,za){if(y(ca[ya.id]))return;var ab=ga(ya)?ya.firstChild:ya,bb=ab.childNodes.length,cb=[],db={},eb={},fb,gb=ba,hb=ba,ib,jb=[];for(var kb=0;kb<bb;kb++){fb=ab.childNodes[kb];if(j.hasClass(fb,'fbTimelineUnit')){ib=m.scry(fb,'.timelineUnitContainer')[0];if(ib)eb[fb.id]=ib.getAttribute('data-time');if(!ia(fb)&&j.shown(fb)){if(ma(fb)=='2'){db[fb.id]=Math.max(gb,hb);gb=hb=db[fb.id]+qa(fb);}else if(ka(fb)=='r'){db[fb.id]=hb;hb+=qa(fb);}else{db[fb.id]=gb;gb+=qa(fb);}if(ka(fb,true)=='l'||ma(fb)=='2')jb.push(fb.id);}}}for(kb=0;kb<jb.length-1;++kb){var lb=jb[kb],mb=jb[kb+1],nb=db[lb]+aa,ob=db[mb];for(var pb in ca[ya.id]){if(nb>ob)break;var qb=ca[ya.id][pb];if(j.shown(qb))continue;if(eb[pb]<=eb[lb]&&eb[pb]>eb[mb]){qb.style.top=nb+"px";nb+=aa;j.show(qb);}}}}function wa(ya,za){var ab=q.byAttribute(ya,'data-size');if(ab){if(j.hasClass(ya.parentNode,'timelineReportContent')){za(ya);}else za(ab);z.balanceCapsule(q.byClass(ab,'fbTimelineCapsule'));}}function xa(ya){var za=0;for(var ab=0;ab<ya.childNodes.length;ab++)if(j.hasClass(ya.childNodes[ab],'fbTimelineUnit'))za++;return za;}return {getUnitsWithTime:function(ya){return m.scry(ya,'.timelineUnitContainer').filter(function(za){return (za.parentNode.parentNode===ya&&za.getAttribute('data-time'));});},removeUnit:function(ya){wa(ya,function(za){l.remove(za);});},hideUnit:function(ya){wa(ya,function(za){j.addClass(za,'fbTimelineColumnHidden');});},undoHideUnit:function(ya,za){l.remove(q.byClass(za,'hiddenText'));wa(ya,function(ab){j.removeClass(ab,'fbTimelineColumnHidden');});},unplacehold:function(ya){var za=g(ya);za.style.top=null;j.removeClass(za,'visiblePlaceholder');j.removeClass(za,'placeholder');var ab=q.byClass(za,'fbTimelineCapsule');delete ca[ab.id][ya];z.balanceCapsule(ab);},scrollToCapsule:function(ya){if(!fa.hasOwnProperty(ya.id)){var za=x.getElementPosition(ya.parentNode);n.scrollTo(new x(x.getScrollPosition().x,za.y-r.SUBSECTION_SCROLL_TO_OFFSET,'document'));fa[ya.id]=true;}},setFirstUnit:function(ya){var za=true,ab=ya.childNodes.length;for(var bb=0;bb<ab;bb++){var cb=ya.childNodes[bb];if(cb.id.indexOf('tl_unit_')===0)if(za){za=false;j.addClass(cb,'firstUnit');}else{j.removeClass(cb,'firstUnit');break;}}},balanceCapsule:function(ya,za){if(!ya)return;if(ya.getAttribute('data-layout')=='fixed'){v.getInstance('balanceCapsuleFixed').debounce(z.balanceFixed.curry(ya,za),ya.id);}else v.getInstance('balanceCapsule').throttle(z.balance.curry(ya,0),ya.id);},balanceFixed:function(ya,za){if(!ya)return;if(w.chrome()||w.safari())j.toggleClass(ya,'webkitFix');var ab=0,bb,cb=document.createDocumentFragment(),db=[],eb=[],fb=[],gb=false,hb=za&&za.use_calculated_heights;for(var ib=0;ib<ya.childNodes.length;ib++){bb=ya.childNodes[ib];if(ha(bb)){continue;}else if(ga(bb)){i(bb.firstChild.childNodes).forEach(function(ob){pa(ob,hb);});continue;}pa(bb,hb);if(ka(bb,true)=='r'){eb.push(bb);}else db.push(bb);fb.push(bb);if(ma(bb)!='2')if((ab>0&&ka(bb)=='r')||(ab<0&&ka(bb)=='l'))gb=true;ab=ra(ab,bb);}var jb=[],kb=[],lb=[];m.scry(ya,'li.fbTimelineBalancer').forEach(function(ob){var pb=i(ob.firstChild.childNodes);if(ob.getAttribute('data-nonunits')){lb=lb.concat(pb);}else if(ka(ob)=='left'){jb=jb.concat(pb);}else if(ka(ob)=='right')kb=kb.concat(pb);});if(gb){ya.style.minHeight=ya.offsetHeight;db.forEach(function(ob){if(ma(ob)!='2')la(ob,'l');});eb.forEach(function(ob){if(ma(ob)!='2')la(ob,'r');});var mb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,db));mb.setAttribute('data-side','left');l.prependContent(ya,mb);jb=db.concat(jb);var nb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,eb));nb.setAttribute('data-side','right');l.prependContent(ya,nb);kb=eb.concat(kb);ab=0;}while((ab>=0&&jb.length)||(ab<0&&kb.length)){if(ab>=0){bb=jb.shift();}else bb=kb.shift();cb.appendChild(bb);ab=ra(ab,bb);}while(lb.length)cb.appendChild(lb.shift());ya.appendChild(cb);m.scry(ya,'li.fbTimelineBalancer').forEach(function(ob){if(!ob.firstChild.childNodes.length)l.remove(ob);});if(za&&za.tail_balance){ab=z.tailBalance(ya,ab,za.tail_balance);}else if(k.get(r.DS_TAILBALANCE,ya.id))ab=z.tailBalance(ya,ab,r.FIXED_SIDE_BOTH);if(gb){fb.forEach(function(ob){if(ob.parentNode!==ya){ya.appendChild(ob);ab=ra(ab,ob);}});ya.style.minHeight=null;}k.set(r.DS_COLUMN_HEIGHT_DIFFERENTIAL,q.byClass(ya,'fbTimelineSection').id,ab);ca[ya.id]={};m.scry(ya,'li.placeholderUnit').forEach(function(ob){ca[ya.id][ob.id]=ob;});va(ya,hb);ta(ya);},tailBalance:function(ya,za,ab){if(!ya)return za;var bb=[],cb=[],db=[],eb=[];m.scry(ya,'li.fbTimelineBalancer').forEach(function(gb){var hb=i(gb.firstChild.childNodes);if(gb.getAttribute('data-nonunits')){eb=eb.concat(hb);}else if(ka(gb)=='left'){cb=cb.concat(hb);}else if(ka(gb)=='right')db=db.concat(hb);bb=bb.concat(hb);});if((ab==r.FIXED_SIDE_RIGHT&&cb.length)||(ab==r.FIXED_SIDE_LEFT&&db.length))return za;var fb=document.createDocumentFragment();if(bb)while(bb.length){if(ma(bb[0])!='2')if(za>=0){la(bb[0],'l');}else la(bb[0],'r');za=ra(za,bb[0]);fb.appendChild(bb.shift());}ya.appendChild(fb);m.scry(ya,'li.fbTimelineBalancer').forEach(function(gb){if(!gb.firstChild.childNodes.length)l.remove(gb);});k.set(r.DS_TAILBALANCE,ya.id,true);return za;},balance:function(ya,za,ab){if(!ya)return;if(!ca[ya.id])ca[ya.id]={};var bb=ga(ya)?ya.firstChild:ya,cb=bb.childNodes.length,db=[],eb=[];if(w.chrome()||w.safari())j.toggleClass(ya,'webkitFix');for(var fb=0;fb<cb;fb++)pa(bb.childNodes[fb]);var gb=false;for(fb=0;fb<cb;fb++){var hb=bb.childNodes[fb];if(ha(hb))continue;var ib=(za>=0),jb=hb.nextSibling;if(ja(hb)){if(ka(hb)=='r'){if(za>0)if(jb&&ma(jb)!='2'){var kb=[hb];while(jb&&ja(jb)&&ka(jb)=='r'){kb.push(jb);jb=jb.nextSibling;}if(jb){if(ga(jb)){var lb=jb.firstChild;l.prependContent(lb,kb);pa(lb);cb-=kb.length;}else l.insertBefore(hb,jb);fb--;}continue;}za+=qa(hb);}else za-=qa(hb);}else if(hb.id&&(ca[ya.id][hb.id]||ia(hb))){ca[ya.id][hb.id]=hb;continue;}else if(ga(hb)){za=z.balance(hb,za);}else if(ma(hb)=='2'){if(jb&&ja(jb)&&ka(jb)=='r'&&za<=0){l.insertBefore(hb,jb);fb--;}else{ib=true;za=0;}}else if(ib){db.push(hb);za-=qa(hb);}else{var mb=false;if(!gb){while(jb&&(!ja(jb)||ka(jb)!='r'))jb=jb.nextSibling;if(jb){l.insertBefore(hb,jb);fb--;mb=true;}else gb=true;}if(!mb){eb.push(hb);za+=qa(hb);}}}na(ya,true);if(ab&&ab.nothrottle){ua(ya,db,eb);va(ya);}else{clearTimeout(ea[ya.id]);ea[ya.id]=setTimeout(function(){v.getInstance('positionUnits').debounce(ua.curry(ya,db,eb),ya.id);delete ea[ya.id];},50);clearTimeout(da[ya.id]);da[ya.id]=setTimeout(function(){v.getInstance('adjustPlaceholders').debounce(va.curry(ya),ya.id);delete da[ya.id];},150);}return za;}};})();e.exports=a.TimelineCapsule||z;});
__d("TimelineComposerUtilities",["event-extensions","Arbiter","Bootloader","CSS","DOM","Parent","TimelineCapsule","Vector"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('TimelineCapsule'),m=b('Vector'),n=86400*31,o=86400000,p={listenToSetEstimatedDate:function(q,r){return g.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,s){if(s.composer===q)s.date_picker.subscribe('initialized',function(t,u){p.setEstimatedDate(u,r());});});},listenToPublish:function(q,r){return g.subscribe('composer/publish',function(event,s){if(s.composer===q)h.loadModules(['TimelineStoryPublisher'],function(t){t.publish(s);r&&r();});});},listenToAnotherComposerOpen:function(q,r){return g.subscribe('composer/mutate',function(s,t){if(t!==q)r();});},listenToCancel:function(q,r){return Event.listen(q,'click',function(event){k.byClass(event.getTarget(),'cancelBtn')&&r();});},hidePlaceIfAttachmentsTooTall:function(q){var r=j.find(q,'ul.fbTimelineComposerAttachments'),s=m.getElementDimensions(r).y;if(s>50){var t=k.byTag(j.scry(r,'span.placeAttachment')[0],'li');t&&i.hide(t);}},setEstimatedDate:function(q,r){var s,t;if(r&&i.hasClass(r,'fbTimelineCapsule')){s=r.getAttribute('data-start');t=r.getAttribute('data-end');if(s&&t){var u=new Date(t*1000);if(t-s>2*n){q.setDate(u.getFullYear());}else q.setDate(u.getFullYear(),u.getMonth()+1);}return;}var v=k.byClass(r,'fbTimelineCapsule');if(v){s=v.getAttribute('data-start');t=v.getAttribute('data-end');var w=m.getElementPosition(r).y,x=[t,null],y=[s,null],z=l.getUnitsWithTime(v);for(var aa=0;aa<z.length;aa++){var ba=z[aa],ca=j.scry(ba.parentNode,'.spinePointer')[0];if(!ca)continue;var da=m.getElementPosition(ca).y;if(da<=w){if(!x[1]||da>x[1])x=[ba.getAttribute('data-time'),da];}else if(!y[1]||da<y[1])y=[ba.getAttribute('data-time'),da];}if(x[0]!==null&&y[0]!==null){var ea=Math.round((parseInt(x[0],10)+parseInt(y[0],10))/2)*1000;ea=Math.min(new Date()-o,ea);q.setDateWithTimestamp(ea);}}}};e.exports=p;});
var TimelineBackdatedComposer=(function(){var a;function b(){c();d();}function c(){a.hide();}function d(){Bootloader.loadComponents('TimelineMLE',function(){var e=TimelineMLE.getFlyout();if(e&&CSS.hasClass(e.getContext(),'backdatedDot'))TimelineMLE.hideFlyout();});}return {init:function(e,f){a=f;var g=[TimelineComposerUtilities.listenToPublish(e,b),TimelineComposerUtilities.listenToAnotherComposerOpen(e,b),TimelineComposerUtilities.listenToSetEstimatedDate(e,a.getContext.bind(a)),e.subscribeToMutate(function(){var i=!DOM.scry(e.root,'.cancelBtn')[0]||DOM.scry(e.root,'.attachmentLifeEvents')[0];if(i){a.enableBehavior(LayerHideOnBlur);}else a.disableBehavior(LayerHideOnBlur);}),Arbiter.subscribe('TimelineMLE/mleFlyoutShown',function(i,j){if(CSS.hasClass(j.getContext(),'backdatedDot')){c();}else b();}),Arbiter.subscribe(TimelineNavigation.UPDATE_PAGE,b)],h=TimelineComposerUtilities.listenToCancel(a.getContent(),b);onleaveRegister(function(){g.forEach(Arbiter.unsubscribe.bind(Arbiter));g=[];h.remove();h=null;});Arbiter.inform('TimelineBackdatedComposer/initialized');},getFlyout:function(){return a;}};})();
__d("legacy:TimelineContentLoader",["TimelineContentLoader"],function(a,b,c,d){a.TimelineContentLoader=b('TimelineContentLoader');},3);
requireLazy(['Selector'],function(a){add_properties('__behaviors',{});if(__behaviors.TimelineCurationControl)return;__behaviors.TimelineCurationControl=true;a.subscribe('open',function(b,c){var d=c.selector,e=c.clone||d,f=Parent.byClass(e,'fbTimelineCurationControl');if(f){CSS.addClass(f,'editControlsMenuOpen');var g=a.subscribe('close',function(h,i){if(i.selector==d){a.unsubscribe(g);CSS.removeClass.curry(f,'editControlsMenuOpen').defer();}});}});});
__d("TimelineComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineCapsule","TimelineComposerUtilities","$"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineCapsule'),n=b('TimelineComposerUtilities'),o=b('$'),p;function q(v){if(v.isScheduledPost||v.isOGPost)return;if(!v.streamStory){window.location.reload();return;}if(v.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(z){z.publish(v);});return;}var w=k.byClass(p,'fbTimelineCapsule');if(!w)return;var x=k.byClass(p,'timelineUnitContainer').parentNode;if(x.nextSibling.getAttribute('data-spine'))x=x.nextSibling;var y=j.insertAfter(x,v.streamStory)[0];h.loadModules(['Animation'],function(z){z(y.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(z.ease.both).go();});m.setFirstUnit(w);m.balanceCapsule(w);}function r(){var v=k.byClass(p,'fbTimelineTwoColumn');return j.find(v,'.spinePointer');}function s(v){var w=t();i.show(w);var x=v.subscribe('hide',function(){i.hide(w);v.unsubscribe(x);});}function t(){var v=k.byClass(p,'fbTimelineTwoColumn'),w=j.scry(v,'div.composerVeil');if(w.length!==1)w=j.appendContent(v,j.create('div',{className:'composerVeil hidden_elem'}));return w[0];}var u={init:function(v){p=o(v);var w=g.subscribe('composer/publish',function(event,x){if(x.composer.root===p)q(x);});l.onLeave(function(){w.unsubscribe();});n.hidePlaceIfAttachmentsTooTall(p);},showMLEFlyout:function(v){v.setContext(r()).show();s(v);}};e.exports=a.TimelineComposer||u;});
__d("legacy:layer",["Layer"],function(a,b,c,d){a.Layer=b('Layer');},3);
function TimelineSpine(){}copy_properties(TimelineSpine,{OFFSET_Y:12,composerFlyout:null,mleFlyout:null,dot:null,loadComposerFlyoutCalled:false,showComposerFlyout:function(a){var b=TimelineSpine.composerFlyout;if(!b){TimelineSpine.loadComposerFlyout(a);TimelineSpine.showComposerFlyoutOnLoad=true;return;}var c=DOM.find(b.getContent(),'div.fbTimelineBackdatedComposer'),d=Composer.getInstance(c);if(d){d.reset();CSS.removeClass(d.root,'uiComposerOpen');}b.enableBehavior(LayerHideOnBlur).setContext(TimelineSpine.dot).updatePosition();b.show();TimelineComposerUtilities.hidePlaceIfAttachmentsTooTall(c);},loadComposerFlyout:function(a){if(TimelineSpine.loadComposerFlyoutCalled||TimelineSpine.composerFlyout)return;TimelineSpine.loadComposerFlyoutCalled=true;onleaveRegister(function(){TimelineSpine.loadComposerFlyoutCalled=false;TimelineSpine.composerFlyout=null;}.bind(this));new AsyncRequest().setURI('/ajax/timeline/backdated_composer.php').setData({targetid:a}).setRelativeTo(TimelineSpine.dot||document.body).send();var b=Arbiter.subscribe('TimelineBackdatedComposer/initialized',function(){TimelineSpine.composerFlyout=TimelineBackdatedComposer.getFlyout();if(TimelineSpine.showComposerFlyoutOnLoad)TimelineSpine.showComposerFlyout(a);TimelineSpine._handleComposerFlyoutDismissed();b.unsubscribe();});},showMLEFlyout:function(a){TimelineSpine.mleFlyout=a;a.setContext(TimelineSpine.dot).show();TimelineSpine.composerFlyout.hide();},_handleComposerFlyoutDismissed:function(){var a=Layer.subscribe('hide',function(b,c){if(TimelineSpine.dot&&c.getContext)if(c.getContext()===TimelineSpine.dot&&!TimelineSpine.mleFlyout){TimelineSpine._hideDot();}else if(c===TimelineSpine.mleFlyout){TimelineSpine.mleFlyout=null;TimelineSpine._hideDot();}});onleaveRegister(function(){Layer.unsubscribe(a);}.bind(this));},_hideDot:function(){DOM.remove(TimelineSpine.dot);TimelineSpine.dot=null;}});copy_properties(TimelineSpine.prototype,{init:function(a,b){this._spine=a;if(!TimelinePerfConfig.getDisableSpineHeight())this._spineHeight=a.offsetHeight;this._plus=DOM.find(a,'.spineHoverPlus');this._capsule=Parent.byClass(a,'fbTimelineCapsule');this._targetid=b;var c=[Event.listen(a,'mouseenter',function(event){TimelineSpine.loadComposerFlyout(this._targetid);this._spineHeight=a.offsetHeight;}.bind(this)),Event.listen(a,'mousemove',this._mouseMoved.bind(this)),Event.listen(a,'click',this._spineClicked.bind(this))];CSS.addClass(this._plus,'spineHoverPlusActive');onleaveRegister(function(){while(c.length)c.pop().remove();}.bind(this));},_mouseMoved:function(event){var a=event.offsetY||event.layerY,b=event.getTarget();if(b!==this._spine)a=b.offsetTop+a;a=Math.min(Math.max(a-TimelineSpine.OFFSET_Y,0),this._spineHeight);this._plus.style.top=a+'px';},_spineClicked:function(event){if(TimelineSpine.mleFlyout){Bootloader.loadComponents('TimelineMLE',TimelineMLE.hideFlyout);return;}TimelineSpine.dot&&DOM.remove(TimelineSpine.dot);TimelineSpine.dot=DOM.create('i',{className:'backdatedDot'});TimelineSpine.dot.style.top=(this._plus.offsetTop-1)+'px';DOM.appendContent(this._spine,TimelineSpine.dot);event.stop();TimelineSpine.showComposerFlyout(this._targetid);}});
function TimelineScrubber(a){this._root=a;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};var b=a.childNodes;this._currentNav=b[0];for(var c=0;c<b.length;c++){var d=b[c].getAttribute('data-key');this._navKeys[d]=b[c];var e=DOM.scry(b[c],'ul');this._subNavKeys[d]={};if(e.length){var f=e[0].childNodes;for(var g=0;g<f.length;g++)this._subNavKeys[d][f[g].getAttribute('data-key')]=f[g];}var h=b[c].getAttribute('data-rollup');if(h){this._rollups[h]=this._rollups[h]||[];this._rollups[h].push(b[c]);}}this._clickListener=Event.listen(this._root,'click',this._handleScrub.bind(this));CSS.show(this._root);var i=Vector2.getViewportDimensions().y-this.SCRUBBER_NO_ADS_VERTICAL_BUFFER,j=this.getHeight();if(j>i)this.fold(j-i);TimelineController.register(TimelineController.SCRUBBER,this);TimelineController.scrubberHasLoaded(this);}copy_properties(TimelineScrubber.prototype,{KEY_HEIGHT:23,SUBKEY_HEIGHT:16,OFFSET:38,SCRUBBER_NO_ADS_VERTICAL_BUFFER:125,reset:function(){this._root=null;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};},getRoot:function(){return this._root;},getNav:function(a){return this._navKeys[a];},getSubnav:function(a,b){return this._subNavKeys[a][b];},getHeight:function(){return this._root.offsetHeight;},getLabelForNav:function(a){var b=this.getNav(a);return b&&DOM.getText(DOM.scry(b,'a')[0]);},getLabelForSubnav:function(a,b){var c=this.getSubnav(a,b);return c&&DOM.getText(DOM.scry(c,'a')[0]);},fold:function(a){return this._adjustFolding(a,true);},unfold:function(a){return this._adjustFolding(a,false);},getOffset:function(){return this.OFFSET+(CSS.hasClass(document.body,'hasVoiceBar')?26:0)+(CSS.hasClass('rightColContent','pagesTimelineRightColumn')?34:0);},updateSection:function(a,b){var c=this._navKeys[a].getAttribute('data-rollup');if(this._currentRollup&&this._currentRollup!=c){CSS.removeClass(this._currentRollup,'selected');CSS.removeClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');delete this._currentRollup;}if(c&&this._rolledup[c]){var d=this._rolledup[c];if(d.getAttribute('data-rollup')){this._currentRollup=d;CSS.addClass(this._currentRollup,'selected');CSS.addClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');}}this._currentNav&&CSS.removeClass(this._currentNav,'selected');this._currentSubNav&&CSS.removeClass(this._currentSubNav,'selected');this._currentNav=null;this._currentSubNav=null;if(this._navKeys[a]){this._currentNav=this._navKeys[a];CSS.addClass(this._currentNav,'selected');if(this.decadesAreSelectable&&this._navKeys[b]){this._currentSubNav=this._navKeys[b];CSS.addClass(this._currentSubNav,'selected');}else if(b&&this._subNavKeys[a][b]){this._currentSubNav=this._subNavKeys[a][b];CSS.addClass(this._currentSubNav,'selected');}}},_getRollupSize:function(a){var b=this._currentNav,c=b&&b.getAttribute('data-rollup'),d=this.KEY_HEIGHT*(this._rollups[a].length-1);if(a==c){d+=this.SUBKEY_HEIGHT*DOM.scry(b,'li').length;d-=this.SUBKEY_HEIGHT*(this._rollups[a].length-1);}return d;},_adjustFolding:function(a,b){var c=a,d=keys(this._rollups);while(a>0&&d.length){var e=d[b?'pop':'shift']();if(!b==!this._rolledup[e])continue;var f=this._getRollupSize(e);if(f<=0)continue;if(!b&&f>a)break;this[b?'_collapseRollup':'_expandRollup'](e);a-=f;}return c-a;},_collapseRollup:function(a){var b=this._rollups[a];if(!b||b.length<2||this._rolledup[a])return;var c=b[0].previousSibling,d=b[0],e=DOM.create('a',{href:d.firstChild.href,rel:'ignore'},[a]),f=DOM.create('ul',{className:'clearfix'});for(var g=0;g<b.length;g++)f.appendChild(b[g]);var h=DOM.create('li',null,[e,f]);if(this.decadesAreSelectable){var i=b[b.length-1],j=d.getAttribute('data-key')+i.getAttribute('data-key');h.setAttribute('data-start',i.getAttribute('data-start'));h.setAttribute('data-end',d.getAttribute('data-end'));h.setAttribute('data-key',j);this._navKeys[j]=h;}else h.setAttribute('data-key',d.getAttribute('data-key'));h.setAttribute('data-rollup',a);if(c){DOM.insertAfter(c,h);}else DOM.prependContent(this._root,h);this._rolledup[a]=h;this._checkSelection();},_expandRollup:function(a){if(!this._rolledup[a])return;var b=this._rolledup[a],c=DOM.scry(b,'ul')[0],d=document.createDocumentFragment();while(c.childNodes.length)d.appendChild(c.firstChild);DOM.replace(b,d);this._rolledup[a]=false;this._checkSelection();},_checkSelection:function(){if(this._currentNav){var a=this._currentSubNav&&this._currentSubNav.getAttribute('data-key');this.updateSection(this._currentNav.getAttribute('data-key'),a);}},_handleScrub:function(event){var a=event.getModifiers();if(event.isMiddleClick()||a.access||a.meta)return true;var b=Parent.byTag(event.getTarget(),'a'),c=b&&Parent.byAttribute(b,'data-key');if(c){TimelineController.scrubberWasClicked(c.getAttribute('data-key'));TimelineController.navigateToSection(c.getAttribute('data-key'));return event.prevent();}}});
function TimelineMainScrubber(a){this.parent.construct(this,a);this._subscribe=Arbiter.subscribe(TimelineController.SECTION_LOADED,function(b,c){var d=this._navKeys[c.key],e=d&&DOM.scry(d,'ul')[0];if(e){CSS.addClass(e,'loaded');TimelineController.scrubberHasChangedState();if(c.hideSubSections)CSS.hide(e);}}.bind(this));}Class.extend(TimelineMainScrubber,'TimelineScrubber');copy_properties(TimelineMainScrubber.prototype,{reset:function(){this.parent.reset();this._subscribe&&this._subscribe.unsubscribe();}});
function StreamProfileComposer(){}copy_properties(StreamProfileComposer.prototype,{init:function(a){var b=$(a);Arbiter.subscribe('composer/publish',function(event,c){if(c.streamStory)animation.prependInsert(b,c.streamStory);});}});
__d("legacy:TooltipLink",["TooltipLink"],function(a,b,c,d){a.TooltipLink=b('TooltipLink');},3);
var SubscribeButton=window.SubscribeButton||(function(){return {init:function(a,b,c,d){Event.listen(b,'click',function(){Arbiter.inform('FollowingUser',{profile_id:d});});Arbiter.subscribe('FollowingUser',function(e,f){if(d===f.profile_id)a.swap();});Arbiter.subscribe('UnfollowingUser',function(e,f){if(d===f.profile_id){a.unswap();c.hideFlyout();Arbiter.inform('SubMenu/Reset');}});},initUnsubscribe:function(a,b){Event.listen(a,'click',function(){Arbiter.inform.bind(Arbiter,'UnfollowingUser',{profile_id:b}).defer();});}};})();